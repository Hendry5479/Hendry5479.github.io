(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{454:function(t,a,s){"use strict";s.r(a);var n=s(45),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("npx = npm run xxx")]),t._v(" "),s("h4",{attrs:{id:"串行构建流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#串行构建流程"}},[t._v("#")]),t._v(" 串行构建流程")]),t._v(" "),s("p",[t._v("读配置参数、初始化编译对象，加载插件，开始编译、确定入口文件、编译模块，递归调用Loader、输出资源、输出文件")]),t._v(" "),s("p",[s("strong",[t._v("初始化参数")]),t._v("：从配置文件和命令读取参数")]),t._v(" "),s("p",[s("strong",[t._v("开始编译")]),t._v("：用得到的参数初始化 Compiler 对象，加载插件，执行对象的 run 方法开始编译；")]),t._v(" "),s("p",[s("strong",[t._v("确定入口")]),t._v("：根据配置中的 entry 找出所有的入口文件；")]),t._v(" "),s("p",[s("strong",[t._v("编译模块")]),t._v("：从入口文件出发，调用Loader 对模块进行翻译，直到所有入口依赖的文件都经过了本步骤的处理；")]),t._v(" "),s("p",[s("strong",[t._v("完成模块编译")]),t._v("：得到每个模块被翻译后的最终内容以及依赖关系；")]),t._v(" "),s("p",[s("strong",[t._v("输出资源")]),t._v("：根据入口和模块的依赖关系，组装成一个个包含多个模块的 Chunk，再把每个 Chunk 转换成单独的文件加入到输出列表")]),t._v(" "),s("p",[s("strong",[t._v("输出完成")]),t._v("：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统。")]),t._v(" "),s("p",[t._v("在以上过程中，Webpack 广播出事件，插件在监听到感兴趣的事件后会执行逻辑，改变 Webpack 的运行结果。")]),t._v(" "),s("h3",{attrs:{id:"入口entry"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#入口entry"}},[t._v("#")]),t._v(" 入口entry")]),t._v(" "),s("ul",[s("li",[t._v("进入entry后，webpack会找出与entry依赖的模块和库；")])]),t._v(" "),s("h3",{attrs:{id:"输出output"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#输出output"}},[t._v("#")]),t._v(" 输出output")]),t._v(" "),s("ul",[s("li",[t._v("定义输出bundle的位置和名称")]),t._v(" "),s("li",[t._v("默认值是 ./dist/main.js，其他文件在./dist")]),t._v(" "),s("li",[t._v("在"),s("strong",[t._v("webpack.config.js")]),t._v("自定义output")])]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dist'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"sourcemap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sourcemap"}},[t._v("#")]),t._v(" SourceMap")]),t._v(" "),s("p",[t._v("devtool：none，false，evel都不会生成sourceMap")]),t._v(" "),s("p",[t._v("sourceMap：从已转换的代码，映射到原始的源文件，方便调试")]),t._v(" "),s("h3",{attrs:{id:"模式-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模式-mode"}},[t._v("#")]),t._v(" 模式(mode)")]),t._v(" "),s("ul",[s("li",[t._v("development, production（默认） 或 none")]),t._v(" "),s("li",[t._v("mode可以启用 webpack 内置在相应环境下的优化")])]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"浏览器兼容性-browser-compatibility"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器兼容性-browser-compatibility"}},[t._v("#")]),t._v(" 浏览器兼容性(browser compatibility)")]),t._v(" "),s("ul",[s("li",[t._v("webpack的import和require.ensure需要Promise")]),t._v(" "),s("li",[t._v("旧浏览器需要提前加载polyfill")])]),t._v(" "),s("h3",{attrs:{id:"环境-environment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境-environment"}},[t._v("#")]),t._v(" 环境(environment)")]),t._v(" "),s("p",[t._v("webpack 5 运行于 Node.js v10.13.0+ 的版本")]),t._v(" "),s("h2",{attrs:{id:"入口起点-entry-points"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#入口起点-entry-points"}},[t._v("#")]),t._v(" 入口起点(entry points)")]),t._v(" "),s("h3",{attrs:{id:"单个入口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单个入口"}},[t._v("#")]),t._v(" 单个入口")]),t._v(" "),s("ul",[s("li",[t._v("可以传入文件路径或文件路径数组给entry属性")]),t._v(" "),s("li",[t._v("传入数组则创建multi-main entry，适用于一次注入多个依赖文件，将依赖关系绘制在一个chunk中的情景")]),t._v(" "),s("li",[t._v("单入口可以快速配置webpack，但灵活性不大")])]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    main"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./path/to/my/entry/file.js'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或")]),t._v("\n  entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/file_1.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/file_2.js'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bundle.js'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"对象语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对象语法"}},[t._v("#")]),t._v(" 对象语法")]),t._v(" "),s("p",[t._v("module.exports = {\nentry: {\napp: './src/app.js',\nadminApp: './src/adminApp.js'\n}\n};")]),t._v(" "),s("ul",[s("li",[t._v("定义入口的最可扩展的方式")]),t._v(" "),s("li",[t._v("配置可拓展指的是可以重复使用，可以组合配置；将关注点从environment, build target, runtime中分离，并用工具进行合并")]),t._v(" "),s("li",[t._v("通过插件生成入口时，可以传入{}")])]),t._v(" "),s("h4",{attrs:{id:"描述入口的对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述入口的对象"}},[t._v("#")]),t._v(" 描述入口的对象")]),t._v(" "),s("p",[t._v("dependOn：当前入口依赖的入口，必须先被加载\nfilename：输出文件名\nimport：加载模块\nlibrary\nruntime：运行时chunk名，未设置将使用入口作为运行时")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    a2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dependingfile.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    b2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      dependOn"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/app.js'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("dependOn和runtime不在同一入口同时使用，否则报错\nruntime不能指向已存在的入口名，否则报错\ndependOn不能循环引用，否则报错")]),t._v(" "),s("h3",{attrs:{id:"常见场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见场景"}},[t._v("#")]),t._v(" 常见场景")]),t._v(" "),s("h4",{attrs:{id:"分离app和vendor-第三方库-入口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分离app和vendor-第三方库-入口"}},[t._v("#")]),t._v(" 分离app和vendor(第三方库)入口")]),t._v(" "),s("p",[t._v("配置两个单独的入口，这样就可以在vendor.js存储未修改的library或文件(例如Bootstrap或jQuery，image)，然后打包成chunk，内容hash不变，浏览器可以独立缓存，减少加载时间")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack.config.js")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    main"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app.js'")]),t._v("\n    vendor"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vendor.js'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack.prod.js")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name].[contenthash].bundle.js'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack.dev.js")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name].bundle.js'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("w4之前vendor作为单独入口添加到entry，编译成单独文件，w4使用optimization.splitChunks将vendor和app分开，并为vendor创建单独文件，而不为vendor创建entry")])]),t._v(" "),s("h4",{attrs:{id:"多页面应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多页面应用"}},[t._v("#")]),t._v(" 多页面应用")]),t._v(" "),s("ul",[s("li",[t._v("多页面应用中，server会拉取新的html文件，页面重新加载并下载资源。")]),t._v(" "),s("li",[t._v("通过这个机会可以使用optimization.splitChunks为页面共享的应用代码创建bundle")]),t._v(" "),s("li",[t._v("多页面应用能复用多个入口之间的代码和模块")])]),t._v(" "),s("h2",{attrs:{id:"输出-output"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#输出-output"}},[t._v("#")]),t._v(" 输出(output)")]),t._v(" "),s("p",[t._v("最低要求：设置为对象，文件名配置为output.filename")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将一个单独的 bundle.js 文件输出到 dist 目录中")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bundle.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"多个入口起点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多个入口起点"}},[t._v("#")]),t._v(" 多个入口起点")]),t._v(" "),s("p",[t._v("如果创建出多个chunk，例如多个入口或使用CommonsChunkPlugin插件，需要使用占位符确保文件名称唯一")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    app"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/app.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    search"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/search.js'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name].js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" __dirname "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/dist'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 写入到硬盘：./dist/app.js, ./dist/search.js")]),t._v("\n")])])]),s("h3",{attrs:{id:"进阶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#进阶"}},[t._v("#")]),t._v(" 进阶")]),t._v(" "),s("p",[t._v("对资源使用 CDN 和 hash 的复杂示例：\nconfig.js")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n  output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/proj/cdn/assets/[fullhash]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    publicPath"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://cdn.example.com/assets/[fullhash]/'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("如果编译时不知道文件的publicPath，可以留空，运行时通过入口的__webpack_public_path__配置")]),t._v(" "),s("div",{staticClass:"language-JavaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("__webpack_public_path__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" myRuntimePublicPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 应用程序入口的其余部分")]),t._v("\n")])])]),s("h2",{attrs:{id:"配置-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-configuration"}},[t._v("#")]),t._v(" 配置(Configuration)")]),t._v(" "),s("ul",[s("li",[t._v("webpack文件内导出了配置对象，webpack根据对象属性进行处理")]),t._v(" "),s("li",[t._v("webpack遵循commonJS规范\n"),s("ul",[s("li",[t._v("可以通过require引入文件，使用npm工具函数")]),t._v(" "),s("li",[t._v("通过js控制流表达式如 ?:")]),t._v(" "),s("li",[t._v("对value进行变量赋值")]),t._v(" "),s("li",[t._v("编写执行函数生成配置")])])])]),t._v(" "),s("h3",{attrs:{id:"基本配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本配置"}},[t._v("#")]),t._v(" 基本配置")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("webpack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'development'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./foo.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dist'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'foo.bundle.js'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"多个target"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多个target"}},[t._v("#")]),t._v(" 多个target")]),t._v(" "),s("ul",[s("li",[t._v("除了可以将单个配置导出为 object，function 或 Promise 以外，还可以将其导出为多个配置")])]),t._v(" "),s("h3",{attrs:{id:"使用其他配置语言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用其他配置语言"}},[t._v("#")]),t._v(" 使用其他配置语言")]),t._v(" "),s("ul",[s("li",[t._v("webpack 支持由多种编程和数据语言编写的配置文件")])]),t._v(" "),s("h2",{attrs:{id:"模块-modules"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模块-modules"}},[t._v("#")]),t._v(" 模块(Modules)")]),t._v(" "),s("p",[t._v("chunk即为模块")]),t._v(" "),s("h3",{attrs:{id:"webpack模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack模块"}},[t._v("#")]),t._v(" webpack模块")]),t._v(" "),s("h3",{attrs:{id:"支持的模块类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#支持的模块类型"}},[t._v("#")]),t._v(" 支持的模块类型")]),t._v(" "),s("p",[t._v("es模块\ncommonJS模块\nAMD模块\nAssets模块\nWebAssembly模块")]),t._v(" "),s("ul",[s("li",[t._v("通过loader使webpack支持多语言和预处理器语法的模块，loader描述了如何处理非原生模块，并把依赖引入bundle")])]),t._v(" "),s("h2",{attrs:{id:"模块解析-modules-resolutions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模块解析-modules-resolutions"}},[t._v("#")]),t._v(" 模块解析(Modules Resolutions)")]),t._v(" "),s("p",[t._v("resolver是寻找模块绝对路径的库，模块可以作为另一个模块的依赖被引入\n打包模块时，webpack使用enhanced-resolve解析路径")]),t._v(" "),s("h3",{attrs:{id:"解析规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解析规则"}},[t._v("#")]),t._v(" 解析规则")]),t._v(" "),s("ul",[s("li",[t._v("绝对路径：不做进一步解析")]),t._v(" "),s("li",[t._v("相对路径：相对路径会拼接上下文路径")]),t._v(" "),s("li",[t._v("模块路径：resolve.modules 指定目录检索模块，具体配置参照resolve.alias\n"),s("ul",[s("li",[t._v("如果 package 包含 package.json，那么 resolve.exportsFields 指定的字段会被依次查找")]),t._v(" "),s("li",[t._v("package.json 的第一个字段会确定 package 中可用的 export")])])]),t._v(" "),s("li",[t._v("resolver 会检查路径是指向文件还是文件夹\n"),s("ul",[s("li",[t._v("路径指向文件：\n"),s("ul",[s("li",[t._v("如果文件有扩展名，则直接将文件打包。")]),t._v(" "),s("li",[t._v("否则使用 resolve.extensions 选项作为文件扩展名来解析，此选项会告诉解析器在解析中能接受那些扩展名（例如 .js，.jsx）")])])]),t._v(" "),s("li",[t._v("路径指向文件夹，则寻找具有正确扩展名的文件：\n"),s("ul",[s("li",[t._v("如果文件夹包含 package.json ，则根据 resolve.mainFields的字段顺序查找，并根据 package.json 中的符合配置要求的第一个字段来确定文件路径。")]),t._v(" "),s("li",[t._v("如果不存在 package.json 或 resolve.mainFields 没有返回有效路径，则根据 resolve.mainFiles 指定的文件名顺序查找，看是否能在 import/require 的目录下匹配到一个存在的文件名")]),t._v(" "),s("li",[t._v("然后使用 resolve.extensions ，以类似的方式解析文件扩展名。")]),t._v(" "),s("li",[t._v("webpack 会根据构建目标，为这些选项提供合理的默认配置")])])])])])]),t._v(" "),s("h3",{attrs:{id:"解析loader"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解析loader"}},[t._v("#")]),t._v(" 解析loader")]),t._v(" "),s("p",[t._v("loader 的解析规则也遵循特定的规范。但是 resolveLoader 配置项可以为 loader 设置独立的解析规则")]),t._v(" "),s("h3",{attrs:{id:"缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#缓存"}},[t._v("#")]),t._v(" 缓存")]),t._v(" "),s("ul",[s("li",[t._v("每次文件系统访问文件都会被缓存，以便于更快触发对同一文件的多个并行或串行请求。")]),t._v(" "),s("li",[t._v("在 watch 模式 下，只有修改过的文件会被从缓存中移出。如果关闭 watch 模式，则会在每次编译前清理缓存")])]),t._v(" "),s("h2",{attrs:{id:"module-federation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#module-federation"}},[t._v("#")]),t._v(" Module Federation")]),t._v(" "),s("h3",{attrs:{id:"动机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动机"}},[t._v("#")]),t._v(" 动机")]),t._v(" "),s("p",[t._v("多个独立的构建组成一个应用，独立的构建不存在依赖关系，可以单独开发部署，称为微前端")]),t._v(" "),s("h3",{attrs:{id:"底层概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#底层概念"}},[t._v("#")]),t._v(" 底层概念")]),t._v(" "),s("ul",[s("li",[t._v("模块分为本地模块和远程模块，远程模块不属于当前构建，并在运行时从容器中加载")]),t._v(" "),s("li",[t._v("加载远程模块是异步操作，被放置在远程模块和入口之间的下一个chunk的加载操作中")]),t._v(" "),s("li",[t._v("chunk的加载操作通过import调用，也支持require.ensure或require()的旧语法")]),t._v(" "),s("li",[t._v("容器由入口创建，入口暴露了对特定模块的异步访问，暴露的访问分为两个步骤：加载异步模块，执行同步模块\n"),s("ul",[s("li",[t._v("加载异步模块在chunk加载期间完成，执行同步模块在其他模块的交错执行期间完成")]),t._v(" "),s("li",[t._v("因此，执行顺序不受模块在本地和远程之间转换的影响")])])]),t._v(" "),s("li",[t._v("容器可以嵌套使用，之间可以循环依赖")])]),t._v(" "),s("h4",{attrs:{id:"重载-overriding"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重载-overriding"}},[t._v("#")]),t._v(" 重载 overriding")]),t._v(" "),s("ul",[s("li",[t._v("容器将本地模块标记为“可重载”，容器的使用者执行重载（提供替换模块）")]),t._v(" "),s("li",[t._v("容器将可重载模块放入一个chunk中，当使用者重写了模块，容器就不再下载对应的可重载模块")]),t._v(" "),s("li",[t._v("替换模块的提供者只提供异步加载函数，容器需要替换模块时才去加载。如果容器不请求则不下载。")]),t._v(" "),s("li",[t._v("name用于标识容器中可重载模块，嵌套使用时，相同name的模块将被自动覆盖")]),t._v(" "),s("li",[t._v("重载的提供的步骤类似于容器暴露模块：加载异步和执行同步")]),t._v(" "),s("li",[t._v("必须在容器模块加载前提供重载，初始chunk中只能被不使用Promise的同步模块重载，一旦执行就不可再重载")])]),t._v(" "),s("h3",{attrs:{id:"高级概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#高级概念"}},[t._v("#")]),t._v(" 高级概念")]),t._v(" "),s("ul",[s("li",[t._v("每个构建是一个容器，也可以将其他构建作为容器。所以构建可以通过从容器中加载模块来访问暴露的模块")]),t._v(" "),s("li",[t._v("共享模块指的是可重写、可作为向嵌套容器提供重写的模块。通常指向构建中的相同模块。")]),t._v(" "),s("li",[t._v("packageName允许通过设置包名来查找版本，自动推断模块请求。")])]),t._v(" "),s("h3",{attrs:{id:"构建块-building-blocks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建块-building-blocks"}},[t._v("#")]),t._v(" 构建块 (Building blocks)")]),t._v(" "),s("ul",[s("li",[t._v("OverridablesPlugin (底层 API)\n"),s("ul",[s("li",[t._v("使特定模块“可重载”。一个本地 API ( __ webpack_override __ ) 允许提供重载。")]),t._v(" "),s("li",[t._v("webpack.config.js")])])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" OverridablesPlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'webpack/lib/container/OverridablesPlugin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OverridablesPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 OverridablesPlugin 定义一个可重载的模块")]),t._v("\n        test1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/test1.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/index.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__webpack_override__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里我们重写 test1 模块")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("test1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'I will override test1 module under src'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("ContainerPlugin (底层 API)")]),t._v(" "),s("ul",[s("li",[t._v("该插件使用指定的公开模块来创建一个额外的容器入口。")]),t._v(" "),s("li",[t._v("它还会在内部使用 OverridablesPlugin，并向容器的使用者暴露 override API。")])])]),t._v(" "),s("li",[s("p",[t._v("ContainerReferencePlugin (底层 API)")]),t._v(" "),s("ul",[s("li",[t._v("该插件将特定的引用添加到作为外部资源（externals）的容器中，并允许从容器中导入远程模块。")]),t._v(" "),s("li",[t._v("它还会调用容器的 override API 来为它们提供重载。")]),t._v(" "),s("li",[t._v("本地的重载（当构建也是容器时，通过 "),s("strong",[t._v("webpack_override")]),t._v(" 或 override API）和指定的重载被提供给所有引用的容器。")])])]),t._v(" "),s("li",[s("p",[t._v("ModuleFederationPlugin （高级 API）")]),t._v(" "),s("ul",[s("li",[t._v("该插件组合了 ContainerPlugin 和 ContainerReferencePlugin。")]),t._v(" "),s("li",[t._v("重载（overrides）和可重载（overridables）被合并到指定共享模块的单个列表中")])])])]),t._v(" "),s("h3",{attrs:{id:"概念目标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概念目标"}},[t._v("#")]),t._v(" 概念目标")]),t._v(" "),s("ul",[s("li",[t._v("既可以暴露，又可以使用 webpack 支持的任何模块类型")]),t._v(" "),s("li",[t._v("代码块加载应该并行加载所需的所有内容 (web到服务器的单次往返)")]),t._v(" "),s("li",[t._v("从使用者到容器的控制\n重写模块是一种单向操作\n同级容器不能重写彼此的模块")]),t._v(" "),s("li",[t._v("概念适用于独立于环境\n可用于 web、Node.js")]),t._v(" "),s("li",[t._v("共享中的相对和绝对请求\n"),s("ul",[s("li",[t._v("会一直提供，即使不使用")]),t._v(" "),s("li",[t._v("会将相对路径解析到 config.context")]),t._v(" "),s("li",[t._v("默认不会使用 requiredVersion")])])]),t._v(" "),s("li",[t._v("共享中的模块请求\n"),s("ul",[s("li",[t._v("只在使用时提供")]),t._v(" "),s("li",[t._v("会匹配构建中所有使用的相等模块请求")]),t._v(" "),s("li",[t._v("将提供所有匹配模块")]),t._v(" "),s("li",[t._v("将从图中这个位置的 package.json 提取 requiredVersion")]),t._v(" "),s("li",[t._v("当你有嵌套的 node_modules 时，可以提供和使用多个不同的版本")])])]),t._v(" "),s("li",[t._v("共享中尾部带有 / 的模块请求将匹配所有具有前缀的模块请求")])]),t._v(" "),s("h3",{attrs:{id:"用例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用例"}},[t._v("#")]),t._v(" 用例")]),t._v(" "),s("h3",{attrs:{id:"动态远程容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动态远程容器"}},[t._v("#")]),t._v(" 动态远程容器")]),t._v(" "),s("p",[t._v("该容器接口支持 get 和 init 方法。 init 是兼容 async 的方法，只含有一个参数：共享作用域对象(shared scope object)。此对象在远程容器中用作共享作用域，并由 host 提供的模块填充。 可以利用它在运行时动态地将远程容器连接到 host 容器。")]),t._v(" "),s("p",[t._v("init.js")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化共享作用域（shared scope）用提供的已知此构建和所有远程的模块填充它")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__webpack_init_sharing__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" container "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("someContainer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或从其他地方获取容器")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化容器 它可能提供共享模块")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" container"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__webpack_share_scopes__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("default"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" module "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" container"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./module'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("p",[t._v("容器尝试提供共享模块，如果共享模块已被使用，则会发出警告，并忽略所提供的共享模块。容器仍能将其作为降级模块。")]),t._v(" "),s("p",[t._v("你可以通过动态加载的方式，提供一个共享模块的不同版本，从而实现 A/B 测试。")]),t._v(" "),s("p",[t._v("Tip：在尝试动态连接远程容器之前，确保已加载容器。")]),t._v(" "),s("p",[t._v("例子：init.js")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadComponent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("scope"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化共享作用域（shared scope）用提供的已知此构建和所有远程的模块填充它")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__webpack_init_sharing__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" container "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("scope"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或从其他地方获取容器")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化容器 它可能提供共享模块")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" container"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__webpack_share_scopes__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("default"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" factory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("scope"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Module "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("factory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadComponent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'abtests'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test123'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"故障排除"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#故障排除"}},[t._v("#")]),t._v(" 故障排除")]),t._v(" "),s("h2",{attrs:{id:"manifest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#manifest"}},[t._v("#")]),t._v(" manifest")]),t._v(" "),s("h2",{attrs:{id:"模块热替换-hmr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模块热替换-hmr"}},[t._v("#")]),t._v(" 模块热替换 HMR")]),t._v(" "),s("p",[t._v("概念：应用程序运行过程中，替换、添加或删除模块，而无需重新加载整个页面\n表现方式：")]),t._v(" "),s("ul",[s("li",[t._v("保留在完全重新加载页面期间丢失的应用程序状态")]),t._v(" "),s("li",[t._v("只更新变更内容")]),t._v(" "),s("li",[t._v("在源代码 CSS/JS 修改时立刻在浏览器更新，相当于在浏览器 devtools 直接更改样式")])]),t._v(" "),s("h2",{attrs:{id:"为什么选择webpack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么选择webpack"}},[t._v("#")]),t._v(" 为什么选择webpack")]),t._v(" "),s("h2",{attrs:{id:"内部原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内部原理"}},[t._v("#")]),t._v(" 内部原理")]),t._v(" "),s("h1",{attrs:{id:"webpack实战"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack实战"}},[t._v("#")]),t._v(" webpack实战")]),t._v(" "),s("h2",{attrs:{id:"webpack基础配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack基础配置"}},[t._v("#")]),t._v(" webpack基础配置")]),t._v(" "),s("p",[t._v("yarn add webpack\nyarn add webpack-cli -D")]),t._v(" "),s("h2",{attrs:{id:"webpack打包文件解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack打包文件解析"}},[t._v("#")]),t._v(" webpack打包文件解析")]),t._v(" "),s("ul",[s("li",[t._v("npx webpack")]),t._v(" "),s("li",[t._v("自定义配置文件："),s("code",[t._v("npx webpack --config webpack.config.my.js")])]),t._v(" "),s("li",[t._v("自定义npx命令\n"),s("ul",[s("li",[t._v("package.json中定义"),s("code",[t._v('scripts: {"build": "webpack --config config.js"}')])]),t._v(" "),s("li",[s("code",[t._v("npm run build")])]),t._v(" "),s("li",[t._v("或 package.json中定义"),s("code",[t._v('scripts: {"build": "webpack"}')])]),t._v(" "),s("li",[s("code",[t._v("npm run build -- -- config config.js")])])])])]),t._v(" "),s("h2",{attrs:{id:"html插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#html插件"}},[t._v("#")]),t._v(" html插件")]),t._v(" "),s("h3",{attrs:{id:"webpack-dev-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack-dev-server"}},[t._v("#")]),t._v(" webpack-dev-server")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("webpack官方提供的小型Express服务器，为webpack打包生成的资源文件提供web服务。")])]),t._v(" "),s("li",[s("p",[t._v("webpack-dev-server 主要提供两个功能：")]),t._v(" "),s("ul",[s("li",[t._v("1.为静态文件提供web服务")]),t._v(" "),s("li",[t._v("2.自动刷新和热替换(HMR)")]),t._v(" "),s("li",[t._v("自动刷新指当修改代码时webpack会自动编译更新内容")]),t._v(" "),s("li",[t._v("热替换指运行时更新各种模块，即局部刷新")])])]),t._v(" "),s("li",[s("p",[t._v("yarn add webpack-dev-server -D")])]),t._v(" "),s("li",[s("p",[t._v("npx webpack-dev-server")])]),t._v(" "),s("li",[s("p",[t._v("config.js")])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  devServer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    progress"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    contentBase"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./build'")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);