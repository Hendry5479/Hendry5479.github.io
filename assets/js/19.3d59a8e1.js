(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{403:function(t,e,n){"use strict";n.r(e);var v=n(45),s=Object(v.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("ol",[n("li",[t._v("Fiber")])]),t._v(" "),n("p",[t._v("React çš„æ ¸å¿ƒæµç¨‹åˆ†ä¸ºreconciliation ï¼ˆrenderï¼‰è°ƒåº¦å’Œcommit")]),t._v(" "),n("p",[t._v("reconciliation "),n("strong",[t._v("render")])]),t._v(" "),n("ul",[n("li",[t._v("æ›´æ–° state ä¸ props")]),t._v(" "),n("li",[t._v("è°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­")]),t._v(" "),n("li",[t._v("ç”Ÿæˆ Fiber Tree")]),t._v(" "),n("li",[t._v("diff ç®—æ³•ï¼Œè·å– vdom change")]),t._v(" "),n("li",[t._v("ç¡®å®šæ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“")])]),t._v(" "),n("p",[n("strong",[t._v("commit")])]),t._v(" "),n("ul",[n("li",[t._v("æ“ä½œ dom èŠ‚ç‚¹æ›´æ–°ï¼›")])]),t._v(" "),n("p",[n("strong",[t._v("å¯¹Fiberçš„è®¤è¯†ï¼š")])]),t._v(" "),n("p",[t._v("React16çš„Fiberä¹‹å‰ï¼Œæ›´æ–°æ˜¯æ— æ³•ä¸­æ–­çš„ï¼Œæ‰€ä»¥å¤§é‡çš„ç»„ä»¶æ¸²æŸ“æ—¶ï¼Œä¸»è¿›ç¨‹ä¼šé•¿æœŸå ç”¨åŒæ­¥é˜»å¡ï¼Œé€ æˆé¡µé¢å¡é¡¿æ‰å¸§ã€‚")]),t._v(" "),n("p",[t._v("ä¸ºäº†å®ç°å¯ä¸­æ–­æ›´æ–°ï¼Œæ”¹å˜è°ƒåº¦reconcilerï¼Œä»stackæ”¹æˆfiberï¼Œå°†ä¸€æ¬¡åŒæ­¥æ›´æ–°ä»»åŠ¡åˆ†å‰²æˆå¤šä¸ªå°ä»»åŠ¡ï¼Œä»¥fiberä¸ºæ›´å°çš„ä»»åŠ¡å•ä½æ‰¿è½½æ¸²æŸ“ï¼Œå®ç°æ›´æ–°çš„å¯ä¸­æ–­ç‰¹æ€§ã€‚")]),t._v(" "),n("p",[t._v("fiberå¦‚ä½•å®ç°æ›´æ–°å¯ä¸­æ–­å‘¢")]),t._v(" "),n("p",[n("strong",[t._v("æ ¸å¿ƒ")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("Fiber å…·è±¡ä¸ºä¸€ä¸ª "),n("strong",[t._v("æ•°æ®ç»“æ„")]),t._v("ï¼Œæœ‰childã€returnã€siblingæŒ‡é’ˆï¼Œé€šè¿‡æŒ‡é’ˆè¿æ¥å½¢æˆä¸€ä¸ªFiberæ ‘")])]),t._v(" "),n("li",[n("p",[t._v("Fiberæ ‘çš„éå†ç®—æ³•ï¼Œéå†è¿‡ç¨‹å¯¹èŠ‚ç‚¹ä¿å­˜å’Œæ˜ å°„å®ç°éšæ—¶çš„åœæ­¢å’Œå›å¤ï¼Œä»è€Œæ”¯æŒä»»åŠ¡åˆ†å‰²çš„ç‰¹æ€§ã€‚")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("é“¾è¡¨æ ‘éå†ç®—æ³•")]),t._v(": é€šè¿‡ "),n("strong",[t._v("èŠ‚ç‚¹ä¿å­˜ä¸æ˜ å°„")]),t._v("ï¼Œä¾¿èƒ½å¤Ÿéšæ—¶åœ°è¿›è¡Œ åœæ­¢å’Œé‡å¯ï¼Œè¿™æ ·ä¾¿èƒ½è¾¾åˆ°å®ç°ä»»åŠ¡åˆ†å‰²çš„åŸºæœ¬å‰æï¼›")]),t._v(" "),n("ul",[n("li",[t._v("1ã€é¦–å…ˆé€šè¿‡ä¸æ–­éå†å­èŠ‚ç‚¹ï¼Œåˆ°æ ‘æœ«å°¾ï¼›")]),t._v(" "),n("li",[t._v("2ã€å¼€å§‹é€šè¿‡ sibling éå†å…„å¼ŸèŠ‚ç‚¹ï¼›")]),t._v(" "),n("li",[t._v("3ã€return è¿”å›çˆ¶èŠ‚ç‚¹ï¼Œç»§ç»­æ‰§è¡Œ2ï¼›")]),t._v(" "),n("li",[t._v("4ã€ç›´åˆ° root èŠ‚ç‚¹åï¼Œè·³å‡ºéå†ï¼›")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("ä»»åŠ¡åˆ†å‰²")]),t._v("ï¼ŒReact ä¸­çš„æ¸²æŸ“æ›´æ–°å¯ä»¥åˆ†æˆä¸¤ä¸ªé˜¶æ®µ:")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("reconciliation é˜¶æ®µ")]),t._v(": vdom çš„æ•°æ®å¯¹æ¯”ï¼Œæ˜¯ä¸ªé€‚åˆæ‹†åˆ†çš„é˜¶æ®µï¼Œæ¯”å¦‚å¯¹æ¯”ä¸€éƒ¨åˆ†æ ‘åï¼Œå…ˆæš‚åœæ‰§è¡Œä¸ªåŠ¨ç”»è°ƒç”¨ï¼Œå¾…å®Œæˆåå†å›æ¥ç»§ç»­æ¯”å¯¹ã€‚")]),t._v(" "),n("li",[n("strong",[t._v("Commit é˜¶æ®µ")]),t._v(": å°† change list æ›´æ–°åˆ° dom ä¸Šï¼Œå¹¶ä¸é€‚åˆæ‹†åˆ†ï¼Œæ‰èƒ½ä¿æŒæ•°æ®ä¸ UI çš„åŒæ­¥ã€‚å¦åˆ™å¯èƒ½ç”±äºé˜»å¡ UI æ›´æ–°ï¼Œè€Œå¯¼è‡´æ•°æ®æ›´æ–°å’Œ UI ä¸ä¸€è‡´çš„æƒ…å†µã€‚")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("åˆ†æ•£æ‰§è¡Œ")]),t._v(": ä»»åŠ¡åˆ†å‰²åï¼Œå°±å¯ä»¥æŠŠå°ä»»åŠ¡å•å…ƒåˆ†æ•£åˆ°æµè§ˆå™¨çš„ç©ºé—²æœŸé—´å»æ’é˜Ÿæ‰§è¡Œï¼Œè€Œå®ç°çš„å…³é”®æ˜¯ä¸¤ä¸ªæ–°API: "),n("code",[t._v("requestIdleCallback")]),t._v(" ä¸ "),n("code",[t._v("requestAnimationFrame")])]),t._v(" "),n("ul",[n("li",[t._v("ä½ä¼˜å…ˆçº§çš„ä»»åŠ¡äº¤ç»™"),n("code",[t._v("requestIdleCallback")]),t._v("å¤„ç†ï¼Œè¿™æ˜¯ä¸ªæµè§ˆå™¨æä¾›çš„äº‹ä»¶å¾ªç¯ç©ºé—²æœŸçš„å›è°ƒå‡½æ•°ï¼Œéœ€è¦ pollyfillï¼Œè€Œä¸”æ‹¥æœ‰ deadline å‚æ•°ï¼Œé™åˆ¶æ‰§è¡Œäº‹ä»¶ï¼Œä»¥ç»§ç»­åˆ‡åˆ†ä»»åŠ¡ï¼›")]),t._v(" "),n("li",[t._v("é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡äº¤ç»™"),n("code",[t._v("requestAnimationFrame")]),t._v("å¤„ç†ï¼›")])])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// ç±»ä¼¼äºè¿™æ ·çš„æ–¹å¼\nrequestIdleCallback((deadline) => {\n    // å½“æœ‰ç©ºé—²æ—¶é—´æ—¶ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªç»„ä»¶æ¸²æŸ“ï¼›\n    // æŠŠä»»åŠ¡å¡åˆ°ä¸€ä¸ªä¸ªç¢ç‰‡æ—¶é—´ä¸­å»ï¼›\n    while ((deadline.timeRemaining() > 0 || deadline.didTimeout) && nextComponent) {\n        nextComponent = performWork(nextComponent);\n    }\n});\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("strong",[t._v("ä¼˜å…ˆçº§ç­–ç•¥")]),t._v(": æ–‡æœ¬æ¡†è¾“å…¥ > æœ¬æ¬¡è°ƒåº¦ç»“æŸéœ€å®Œæˆçš„ä»»åŠ¡ > åŠ¨ç”»è¿‡æ¸¡ > äº¤äº’åé¦ˆ > æ•°æ®æ›´æ–° > ä¸ä¼šæ˜¾ç¤ºä½†ä»¥é˜²å°†æ¥ä¼šæ˜¾ç¤ºçš„ä»»åŠ¡")])]),t._v(" "),n("h3",{attrs:{id:"_2-ç”Ÿå‘½å‘¨æœŸ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç”Ÿå‘½å‘¨æœŸ"}},[t._v("#")]),t._v(" 2. ç”Ÿå‘½å‘¨æœŸ")]),t._v(" "),n("p",[t._v("å› ä¸ºfiberæ¶æ„å‡ºç°ï¼Œç”Ÿå‘½å‘¨æœŸçš„æ–°"),n("strong",[t._v("å˜åŠ¨")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("ä½¿ç”¨"),n("code",[t._v("getDerivedStateFromProps")]),t._v(" æ›¿æ¢ "),n("code",[t._v("componentWillMount")]),t._v(" ä¸ "),n("code",[t._v("componentWillReceiveProps")]),t._v("ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("ä½¿ç”¨"),n("code",[t._v("getSnapshotBeforeUpdate")]),t._v("æ›¿æ¢"),n("code",[t._v("componentWillUpdate")]),t._v("ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("é¿å…ä½¿ç”¨"),n("code",[t._v("componentWillReceiveProps")]),t._v("ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("** reconciliation**:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("componentWillMount")])]),t._v(" "),n("li",[n("code",[t._v("componentWillReceiveProps")])]),t._v(" "),n("li",[n("code",[t._v("shouldComponentUpdate")])]),t._v(" "),n("li",[n("code",[t._v("componentWillUpdate")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("commit")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("componentDidMount")])]),t._v(" "),n("li",[n("code",[t._v("componentDidUpdate")])]),t._v(" "),n("li",[n("code",[t._v("componentWillUnmount")])])])])]),t._v(" "),n("p",[t._v("åœ¨ Fiber ä¸­ï¼Œreconciliation é˜¶æ®µè¿›è¡Œäº†ä»»åŠ¡åˆ†å‰²ï¼Œæ¶‰åŠåˆ° æš‚åœ å’Œ é‡å¯ï¼Œå› æ­¤å¯èƒ½ä¼šå¯¼è‡´ reconciliation ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°åœ¨ä¸€æ¬¡æ›´æ–°æ¸²æŸ“å¾ªç¯ä¸­è¢« "),n("strong",[t._v("å¤šæ¬¡è°ƒç”¨")]),t._v(" çš„æƒ…å†µï¼Œäº§ç”Ÿä¸€äº›æ„å¤–é”™è¯¯ã€‚")]),t._v(" "),n("p",[t._v("æ–°ç‰ˆçš„å»ºè®®ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("class Component extends React.Component {\n  // æ›¿æ¢ `componentWillReceiveProps` ï¼Œ\n  // åˆå§‹åŒ–å’Œ update æ—¶è¢«è°ƒç”¨\n  // é™æ€å‡½æ•°ï¼Œæ— æ³•ä½¿ç”¨ this\n  static getDerivedStateFromProps(nextProps, prevState) {}\n  \n  // åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°ç»„ä»¶\n  // å¯ä»¥ç”¨äºç»„ä»¶æ€§èƒ½ä¼˜åŒ–\n  shouldComponentUpdate(nextProps, nextState) {}\n  \n  // ç»„ä»¶è¢«æŒ‚è½½åè§¦å‘\n  componentDidMount() {}\n  \n  // æ›¿æ¢ componentWillUpdate\n  // å¯ä»¥åœ¨æ›´æ–°ä¹‹å‰è·å–æœ€æ–° dom æ•°æ®\n  getSnapshotBeforeUpdate() {}\n  \n  // ç»„ä»¶æ›´æ–°åè°ƒç”¨\n  componentDidUpdate() {}\n  \n  // ç»„ä»¶å³å°†é”€æ¯\n  componentWillUnmount() {}\n  \n  // ç»„ä»¶å·²é”€æ¯\n  componentDidUnmount() {}\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("p",[n("strong",[t._v("ä½¿ç”¨å»ºè®®")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("åœ¨"),n("code",[t._v("constructor")]),t._v("åˆå§‹åŒ– stateï¼›")])]),t._v(" "),n("li",[n("p",[t._v("åœ¨"),n("code",[t._v("componentDidMount")]),t._v("ä¸­è¿›è¡Œäº‹ä»¶ç›‘å¬ï¼Œå¹¶åœ¨"),n("code",[t._v("componentWillUnmount")]),t._v("ä¸­è§£ç»‘äº‹ä»¶ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("åœ¨"),n("code",[t._v("componentDidMount")]),t._v("ä¸­è¿›è¡Œæ•°æ®çš„è¯·æ±‚ï¼Œè€Œä¸æ˜¯åœ¨"),n("code",[t._v("componentWillMount")]),t._v("ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("éœ€è¦æ ¹æ® props æ›´æ–° state æ—¶ï¼Œä½¿ç”¨")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("getDerivedStateFromProps(nextProps, prevState)\n")])])]),n("ul",[n("li",[t._v("æ—§ props éœ€è¦è‡ªå·±å­˜å‚¨ï¼Œä»¥ä¾¿æ¯”è¾ƒï¼›")])])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("public static getDerivedStateFromProps(nextProps, prevState) {\n\t// å½“æ–° props ä¸­çš„ data å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŒæ­¥æ›´æ–°åˆ° state ä¸Š\n\tif (nextProps.data !== prevState.data) {\n\t\treturn {\n\t\t\tdata: nextProps.data\n\t\t}\n\t} else {\n\t\treturn null1\n\t}\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[t._v("å¯ä»¥åœ¨"),n("code",[t._v("componentDidUpdate")]),t._v("ç›‘å¬ props æˆ–è€… state çš„å˜åŒ–ï¼Œä¾‹å¦‚:")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("componentDidUpdate(prevProps) {\n\t// å½“ id å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°è·å–æ•°æ®\n\tif (this.props.id !== prevProps.id) {\n\t\tthis.fetchData(this.props.id);\n\t}\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[t._v("åœ¨"),n("code",[t._v("componentDidUpdate")]),t._v("ä½¿ç”¨"),n("code",[t._v("setState")]),t._v("æ—¶ï¼Œå¿…é¡»åŠ æ¡ä»¶ï¼Œå¦åˆ™å°†è¿›å…¥æ­»å¾ªç¯ï¼›")]),t._v(" "),n("li",[n("code",[t._v("getSnapshotBeforeUpdate(prevProps, prevState)")]),t._v("å¯ä»¥åœ¨æ›´æ–°ä¹‹å‰è·å–æœ€æ–°çš„æ¸²æŸ“æ•°æ®ï¼Œå®ƒçš„è°ƒç”¨æ˜¯åœ¨ render ä¹‹åï¼Œ update ä¹‹å‰ï¼›")]),t._v(" "),n("li",[n("code",[t._v("shouldComponentUpdate")]),t._v(": é»˜è®¤æ¯æ¬¡è°ƒç”¨"),n("code",[t._v("setState")]),t._v("ï¼Œä¸€å®šä¼šæœ€ç»ˆèµ°åˆ° diff é˜¶æ®µï¼Œä½†å¯ä»¥é€šè¿‡"),n("code",[t._v("shouldComponentUpdate")]),t._v("çš„ç”Ÿå‘½é’©å­è¿”å›"),n("code",[t._v("false")]),t._v("æ¥ç›´æ¥é˜»æ­¢åé¢çš„é€»è¾‘æ‰§è¡Œï¼Œé€šå¸¸æ˜¯ç”¨äºåšæ¡ä»¶æ¸²æŸ“ï¼Œä¼˜åŒ–æ¸²æŸ“çš„æ€§èƒ½ã€‚")])])])]),t._v(" "),n("h3",{attrs:{id:"_3-setstate"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-setstate"}},[t._v("#")]),t._v(" 3. setState")]),t._v(" "),n("p",[t._v("åœ¨äº†è§£"),n("code",[t._v("setState")]),t._v("ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸‹ React ä¸€ä¸ªåŒ…è£…ç»“æ„: "),n("strong",[t._v("Transaction")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("äº‹åŠ¡")]),t._v(" "),n("p",[t._v("(Transaction):")]),t._v(" "),n("ul",[n("li",[t._v("æ˜¯ React ä¸­çš„ä¸€ä¸ªè°ƒç”¨ç»“æ„ï¼Œç”¨äºåŒ…è£…ä¸€ä¸ªæ–¹æ³•ï¼Œç»“æ„ä¸º: "),n("strong",[t._v("initialize - perform(method) - close")]),t._v("ã€‚é€šè¿‡äº‹åŠ¡ï¼Œå¯ä»¥ç»Ÿä¸€ç®¡ç†ä¸€ä¸ªæ–¹æ³•çš„å¼€å§‹ä¸ç»“æŸï¼›å¤„äºäº‹åŠ¡æµä¸­ï¼Œè¡¨ç¤ºè¿›ç¨‹æ­£åœ¨æ‰§è¡Œä¸€äº›æ“ä½œï¼›")])])])]),t._v(" "),n("p",[n("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/3/21/1699e0cb48cd4013~tplv-t2oaga2asx-watermark.awebp",alt:"img"}})]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("setState")]),t._v(": React ä¸­ç”¨äºä¿®æ”¹çŠ¶æ€ï¼Œæ›´æ–°è§†å›¾ã€‚å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("å¼‚æ­¥ä¸åŒæ­¥")]),t._v(": "),n("code",[t._v("setState")]),t._v("å¹¶ä¸æ˜¯å•çº¯çš„å¼‚æ­¥æˆ–åŒæ­¥ï¼Œè¿™å…¶å®ä¸è°ƒç”¨æ—¶çš„ç¯å¢ƒç›¸å…³:")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("åœ¨")]),t._v(" "),n("p",[t._v("åˆæˆäº‹ä»¶")]),t._v(" "),n("p",[t._v("å’Œ")]),t._v(" "),n("p",[t._v("ç”Ÿå‘½å‘¨æœŸé’©å­(é™¤ componentDidUpdate)")]),t._v(" "),n("p",[t._v("ä¸­ï¼Œ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("setState\n")])])]),n("p",[t._v('æ˜¯"å¼‚æ­¥"çš„ï¼›')]),t._v(" "),n("ul",[n("li",[n("p",[t._v("åŸå› ")]),t._v(" "),n("p",[t._v(": å› ä¸ºåœ¨")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("setState\n")])])]),n("p",[t._v("çš„å®ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªåˆ¤æ–­: å½“æ›´æ–°ç­–ç•¥æ­£åœ¨äº‹åŠ¡æµçš„æ‰§è¡Œä¸­æ—¶ï¼Œè¯¥ç»„ä»¶æ›´æ–°ä¼šè¢«æ¨å…¥")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("dirtyComponents\n")])])]),n("p",[t._v("é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œï¼›å¦åˆ™ï¼Œå¼€å§‹æ‰§è¡Œ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("batchedUpdates\n")])])]),n("p",[t._v("é˜Ÿåˆ—æ›´æ–°ï¼›")]),t._v(" "),n("ul",[n("li",[t._v("åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­è°ƒç”¨ä¸­ï¼Œæ›´æ–°ç­–ç•¥éƒ½å¤„äºæ›´æ–°ä¹‹å‰ï¼Œç»„ä»¶ä»å¤„äºäº‹åŠ¡æµä¸­ï¼Œè€Œ"),n("code",[t._v("componentDidUpdate")]),t._v("æ˜¯åœ¨æ›´æ–°ä¹‹åï¼Œæ­¤æ—¶ç»„ä»¶å·²ç»ä¸åœ¨äº‹åŠ¡æµä¸­äº†ï¼Œå› æ­¤åˆ™ä¼šåŒæ­¥æ‰§è¡Œï¼›")]),t._v(" "),n("li",[t._v("åœ¨åˆæˆäº‹ä»¶ä¸­ï¼ŒReact æ˜¯åŸºäº "),n("strong",[t._v("äº‹åŠ¡æµå®Œæˆçš„äº‹ä»¶å§”æ‰˜æœºåˆ¶")]),t._v(" å®ç°ï¼Œä¹Ÿæ˜¯å¤„äºäº‹åŠ¡æµä¸­ï¼›")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("é—®é¢˜")]),t._v(": æ— æ³•åœ¨"),n("code",[t._v("setState")]),t._v("åé©¬ä¸Šä»"),n("code",[t._v("this.state")]),t._v("ä¸Šè·å–æ›´æ–°åçš„å€¼ã€‚")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("è§£å†³")]),t._v(": å¦‚æœéœ€è¦é©¬ä¸ŠåŒæ­¥å»è·å–æ–°å€¼ï¼Œ"),n("code",[t._v("setState")]),t._v("å…¶å®æ˜¯å¯ä»¥ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°çš„ã€‚"),n("code",[t._v("setState(updater, callback)")]),t._v("ï¼Œåœ¨å›è°ƒä¸­å³å¯è·å–æœ€æ–°å€¼ï¼›")])])])]),t._v(" "),n("li",[n("p",[t._v("åœ¨")]),t._v(" "),n("p",[t._v("åŸç”Ÿäº‹ä»¶")]),t._v(" "),n("p",[t._v("å’Œ")]),t._v(" "),n("p",[t._v("setTimeout")]),t._v(" "),n("p",[t._v("ä¸­ï¼Œ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("setState\n")])])]),n("p",[t._v("æ˜¯åŒæ­¥çš„ï¼Œå¯ä»¥é©¬ä¸Šè·å–æ›´æ–°åçš„å€¼ï¼›")]),t._v(" "),n("ul",[n("li",[t._v("åŸå› : åŸç”Ÿäº‹ä»¶æ˜¯æµè§ˆå™¨æœ¬èº«çš„å®ç°ï¼Œä¸äº‹åŠ¡æµæ— å…³ï¼Œè‡ªç„¶æ˜¯åŒæ­¥ï¼›è€Œ"),n("code",[t._v("setTimeout")]),t._v("æ˜¯æ”¾ç½®äºå®šæ—¶å™¨çº¿ç¨‹ä¸­å»¶åæ‰§è¡Œï¼Œæ­¤æ—¶äº‹åŠ¡æµå·²ç»“æŸï¼Œå› æ­¤ä¹Ÿæ˜¯åŒæ­¥ï¼›")])])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("æ‰¹é‡æ›´æ–°")]),t._v(": åœ¨ "),n("strong",[t._v("åˆæˆäº‹ä»¶")]),t._v(" å’Œ "),n("strong",[t._v("ç”Ÿå‘½å‘¨æœŸé’©å­")]),t._v(" ä¸­ï¼Œ"),n("code",[t._v("setState")]),t._v("æ›´æ–°é˜Ÿåˆ—æ—¶ï¼Œå­˜å‚¨çš„æ˜¯ "),n("strong",[t._v("åˆå¹¶çŠ¶æ€")]),t._v("("),n("code",[t._v("Object.assign")]),t._v(")ã€‚å› æ­¤å‰é¢è®¾ç½®çš„ key å€¼ä¼šè¢«åé¢æ‰€è¦†ç›–ï¼Œæœ€ç»ˆåªä¼šæ‰§è¡Œä¸€æ¬¡æ›´æ–°ï¼›")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("å‡½æ•°å¼")]),t._v(": ç”±äº Fiber åŠ åˆå¹¶ çš„é—®é¢˜ï¼Œå®˜æ–¹æ¨èå¯ä»¥ä¼ å…¥ "),n("strong",[t._v("å‡½æ•°")]),t._v(" çš„å½¢å¼ã€‚"),n("code",[t._v("setState(fn)")]),t._v("ï¼Œåœ¨"),n("code",[t._v("fn")]),t._v("ä¸­è¿”å›æ–°çš„"),n("code",[t._v("state")]),t._v("å¯¹è±¡å³å¯ï¼Œä¾‹å¦‚"),n("code",[t._v("this.setState((state, props) => newState)ï¼›")])]),t._v(" "),n("ul",[n("li",[t._v("ä½¿ç”¨å‡½æ•°å¼ï¼Œå¯ä»¥ç”¨äºé¿å…"),n("code",[t._v("setState")]),t._v("çš„æ‰¹é‡æ›´æ–°çš„é€»è¾‘ï¼Œä¼ å…¥çš„å‡½æ•°å°†ä¼šè¢« "),n("strong",[t._v("é¡ºåºè°ƒç”¨")]),t._v("ï¼›")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("æ³¨æ„äº‹é¡¹")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("setState åˆå¹¶ï¼Œåœ¨ åˆæˆäº‹ä»¶ å’Œ ç”Ÿå‘½å‘¨æœŸé’©å­ ä¸­å¤šæ¬¡è¿ç»­è°ƒç”¨ä¼šè¢«ä¼˜åŒ–ä¸ºä¸€æ¬¡ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("å½“ç»„ä»¶å·²è¢«é”€æ¯ï¼Œå¦‚æœå†æ¬¡è°ƒç”¨")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("setState\n")])])]),n("p",[t._v("ï¼ŒReact ä¼šæŠ¥é”™è­¦å‘Šï¼Œé€šå¸¸æœ‰ä¸¤ç§è§£å†³åŠæ³•:")]),t._v(" "),n("ul",[n("li",[t._v("å°†æ•°æ®æŒ‚è½½åˆ°å¤–éƒ¨ï¼Œé€šè¿‡ props ä¼ å…¥ï¼Œå¦‚æ”¾åˆ° Redux æˆ– çˆ¶çº§ä¸­ï¼›")]),t._v(" "),n("li",[t._v("åœ¨ç»„ä»¶å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€é‡ (isUnmounted)ï¼Œ"),n("code",[t._v("componentWillUnmount")]),t._v("ä¸­æ ‡è®°ä¸º trueï¼Œåœ¨"),n("code",[t._v("setState")]),t._v("å‰è¿›è¡Œåˆ¤æ–­ï¼›")])])])])])]),t._v(" "),n("h3",{attrs:{id:"_4-hoc-é«˜é˜¶ç»„ä»¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-hoc-é«˜é˜¶ç»„ä»¶"}},[t._v("#")]),t._v(" 4. HOC(é«˜é˜¶ç»„ä»¶)")]),t._v(" "),n("p",[t._v("HOC(Higher Order Componennt) æ˜¯åœ¨ React æœºåˆ¶ä¸‹ç¤¾åŒºå½¢æˆçš„ä¸€ç§ç»„ä»¶æ¨¡å¼ï¼Œåœ¨å¾ˆå¤šç¬¬ä¸‰æ–¹å¼€æºåº“ä¸­è¡¨ç°å¼ºå¤§ã€‚")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("ç®€è¿°")]),t._v(":")]),t._v(" "),n("ul",[n("li",[t._v("é«˜é˜¶ç»„ä»¶ä¸æ˜¯ç»„ä»¶ï¼Œæ˜¯ "),n("strong",[t._v("å¢å¼ºå‡½æ•°")]),t._v("ï¼Œå¯ä»¥è¾“å…¥ä¸€ä¸ªå…ƒç»„ä»¶ï¼Œè¿”å›å‡ºä¸€ä¸ªæ–°çš„å¢å¼ºç»„ä»¶ï¼›")]),t._v(" "),n("li",[t._v("é«˜é˜¶ç»„ä»¶çš„ä¸»è¦ä½œç”¨æ˜¯ "),n("strong",[t._v("ä»£ç å¤ç”¨")]),t._v("ï¼Œ"),n("strong",[t._v("æ“ä½œ")]),t._v(" çŠ¶æ€å’Œå‚æ•°ï¼›")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("ç”¨æ³•")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("å±æ€§ä»£ç† (Props Proxy)")]),t._v(": è¿”å›å‡ºä¸€ä¸ªç»„ä»¶ï¼Œå®ƒåŸºäºè¢«åŒ…è£¹ç»„ä»¶è¿›è¡Œ "),n("strong",[t._v("åŠŸèƒ½å¢å¼º")]),t._v("ï¼›")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("é»˜è®¤å‚æ•°")]),t._v(": å¯ä»¥ä¸ºç»„ä»¶åŒ…è£¹ä¸€å±‚é»˜è®¤å‚æ•°ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function proxyHoc(Comp) {\n\treturn class extends React.Component {\n\t\trender() {\n\t\t\tconst newProps = {\n\t\t\t\tname: 'tayde',\n\t\t\t\tage: 1,\n\t\t\t}\n\t\t\treturn <Comp {...this.props} {...newProps} />\n\t\t}\n\t}\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("strong",[t._v("æå–çŠ¶æ€")]),t._v(": å¯ä»¥é€šè¿‡ props å°†è¢«åŒ…è£¹ç»„ä»¶ä¸­çš„ state ä¾èµ–å¤–å±‚ï¼Œä¾‹å¦‚ç”¨äºè½¬æ¢å—æ§ç»„ä»¶:")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function withOnChange(Comp) {\n\treturn class extends React.Component {\n\t\tconstructor(props) {\n\t\t\tsuper(props)\n\t\t\tthis.state = {\n\t\t\t\tname: '',\n\t\t\t}\n\t\t}\n\t\tonChangeName = () => {\n\t\t\tthis.setState({\n\t\t\t\tname: 'dongdong',\n\t\t\t})\n\t\t}\n\t\trender() {\n\t\t\tconst newProps = {\n\t\t\t\tvalue: this.state.name,\n\t\t\t\tonChange: this.onChangeName,\n\t\t\t}\n\t\t\treturn <Comp {...this.props} {...newProps} />\n\t\t}\n\t}\n}\nå¤åˆ¶ä»£ç \n")])])]),n("p",[t._v("ä½¿ç”¨å§¿åŠ¿å¦‚ä¸‹ï¼Œè¿™æ ·å°±èƒ½éå¸¸å¿«é€Ÿçš„å°†ä¸€ä¸ª "),n("code",[t._v("Input")]),t._v(" ç»„ä»¶è½¬åŒ–æˆå—æ§ç»„ä»¶ã€‚")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('const NameInput = props => (<input name="name" {...props} />)\nexport default withOnChange(NameInput)\nå¤åˆ¶ä»£ç \n')])])]),n("ul",[n("li",[n("strong",[t._v("åŒ…è£¹ç»„ä»¶")]),t._v(": å¯ä»¥ä¸ºè¢«åŒ…è£¹å…ƒç´ è¿›è¡Œä¸€å±‚åŒ…è£…ï¼Œ")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function withMask(Comp) {\n  return class extends React.Component {\n      render() {\n\t\t  return (\n\t\t      <div>\n\t\t\t\t  <Comp {...this.props} />\n\t\t\t\t\t<div style={{\n\t\t\t\t\t  width: '100%',\n\t\t\t\t\t  height: '100%',\n\t\t\t\t\t  backgroundColor: 'rgba(0, 0, 0, .6)',\n\t\t\t\t  }} \n\t\t\t  </div>\n\t\t  )\n\t  }\n  }\n}\nå¤åˆ¶ä»£ç \n")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("åå‘ç»§æ‰¿")]),t._v(" (Inheritance Inversion): è¿”å›å‡ºä¸€ä¸ªç»„ä»¶ï¼Œ"),n("strong",[t._v("ç»§æ‰¿äºè¢«åŒ…è£¹ç»„ä»¶")]),t._v("ï¼Œå¸¸ç”¨äºä»¥ä¸‹æ“ä½œ:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function IIHoc(Comp) {\n    return class extends Comp {\n        render() {\n            return super.render();\n        }\n    };\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("p",[n("strong",[t._v("æ¸²æŸ“åŠ«æŒ")]),t._v(" (Render Highjacking)")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("æ¡ä»¶æ¸²æŸ“")]),t._v(": æ ¹æ®æ¡ä»¶ï¼Œæ¸²æŸ“ä¸åŒçš„ç»„ä»¶")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function withLoading(Comp) {\n    return class extends Comp {\n        render() {\n            if(this.props.isLoading) {\n                return <Loading />\n            } else {\n                return super.render()\n            }\n        }\n    };\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[t._v("å¯ä»¥ç›´æ¥ä¿®æ”¹è¢«åŒ…è£¹ç»„ä»¶æ¸²æŸ“å‡ºçš„ React å…ƒç´ æ ‘")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("æ“ä½œçŠ¶æ€")]),t._v(" (Operate State): å¯ä»¥ç›´æ¥é€šè¿‡ "),n("code",[t._v("this.state")]),t._v(" è·å–åˆ°è¢«åŒ…è£¹ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶è¿›è¡Œæ“ä½œã€‚ä½†è¿™æ ·çš„æ“ä½œå®¹æ˜“ä½¿ state å˜å¾—éš¾ä»¥è¿½è¸ªï¼Œä¸æ˜“ç»´æŠ¤ï¼Œè°¨æ…ä½¿ç”¨ã€‚")])])])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("åº”ç”¨åœºæ™¯")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("æƒé™æ§åˆ¶")]),t._v("ï¼Œé€šè¿‡æŠ½è±¡é€»è¾‘ï¼Œç»Ÿä¸€å¯¹é¡µé¢è¿›è¡Œæƒé™åˆ¤æ–­ï¼ŒæŒ‰ä¸åŒçš„æ¡ä»¶è¿›è¡Œé¡µé¢æ¸²æŸ“:")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function withAdminAuth(WrappedComponent) {\n    return class extends React.Component {\n\t\tconstructor(props){\n\t\t\tsuper(props)\n\t\t\tthis.state = {\n\t\t    \tisAdmin: false,\n\t\t\t}\n\t\t} \n\t\tasync componentWillMount() {\n\t\t    const currentRole = await getCurrentUserRole();\n\t\t    this.setState({\n\t\t        isAdmin: currentRole === 'Admin',\n\t\t    });\n\t\t}\n\t\trender() {\n\t\t    if (this.state.isAdmin) {\n\t\t        return <Comp {...this.props} />;\n\t\t    } else {\n\t\t        return (<div>æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹è¯¥é¡µé¢ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼</div>);\n\t\t    }\n\t\t}\n    };\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("strong",[t._v("æ€§èƒ½ç›‘æ§")]),t._v("ï¼ŒåŒ…è£¹ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿›è¡Œç»Ÿä¸€åŸ‹ç‚¹:")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function withTiming(Comp) {\n    return class extends Comp {\n        constructor(props) {\n            super(props);\n            this.start = Date.now();\n            this.end = 0;\n        }\n        componentDidMount() {\n            super.componentDidMount && super.componentDidMount();\n            this.end = Date.now();\n            console.log(`${WrappedComponent.name} ç»„ä»¶æ¸²æŸ“æ—¶é—´ä¸º ${this.end - this.start} ms`);\n        }\n        render() {\n            return super.render();\n        }\n    };\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("strong",[t._v("ä»£ç å¤ç”¨")]),t._v("ï¼Œå¯ä»¥å°†é‡å¤çš„é€»è¾‘è¿›è¡ŒæŠ½è±¡ã€‚")])])]),t._v(" "),n("li",[n("p",[t._v("ä½¿ç”¨æ³¨æ„:")]),t._v(" "),n("ul",[n("li",[n("ol",[n("li",[n("strong",[t._v("çº¯å‡½æ•°")]),t._v(": å¢å¼ºå‡½æ•°åº”ä¸ºçº¯å‡½æ•°ï¼Œé¿å…ä¾µå…¥ä¿®æ”¹å…ƒç»„ä»¶ï¼›")])])]),t._v(" "),n("li",[n("ol",[n("li",[n("strong",[t._v("é¿å…ç”¨æ³•æ±¡æŸ“")]),t._v(": ç†æƒ³çŠ¶æ€ä¸‹ï¼Œåº”é€ä¼ å…ƒç»„ä»¶çš„æ— å…³å‚æ•°ä¸äº‹ä»¶ï¼Œå°½é‡ä¿è¯ç”¨æ³•ä¸å˜ï¼›")])])]),t._v(" "),n("li",[n("ol",[n("li",[n("strong",[t._v("å‘½åç©ºé—´")]),t._v(": ä¸º HOC å¢åŠ ç‰¹å¼‚æ€§çš„ç»„ä»¶åç§°ï¼Œè¿™æ ·èƒ½ä¾¿äºå¼€å‘è°ƒè¯•å’ŒæŸ¥æ‰¾é—®é¢˜ï¼›")])])]),t._v(" "),n("li",[n("ol",[n("li",[n("strong",[t._v("å¼•ç”¨ä¼ é€’")]),t._v(": å¦‚æœéœ€è¦ä¼ é€’å…ƒç»„ä»¶çš„ refs å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨"),n("code",[t._v("React.forwardRef")]),t._v("ï¼›")])])]),t._v(" "),n("li",[n("ol",[n("li",[n("strong",[t._v("é™æ€æ–¹æ³•")]),t._v(": å…ƒç»„ä»¶ä¸Šçš„é™æ€æ–¹æ³•å¹¶æ— æ³•è¢«è‡ªåŠ¨ä¼ å‡ºï¼Œä¼šå¯¼è‡´ä¸šåŠ¡å±‚æ— æ³•è°ƒç”¨ï¼›è§£å†³:")])]),t._v(" "),n("ul",[n("li",[t._v("å‡½æ•°å¯¼å‡º")]),t._v(" "),n("li",[t._v("é™æ€æ–¹æ³•èµ‹å€¼")])])]),t._v(" "),n("li",[n("ol",[n("li",[n("strong",[t._v("é‡æ–°æ¸²æŸ“")]),t._v(": ç”±äºå¢å¼ºå‡½æ•°æ¯æ¬¡è°ƒç”¨æ˜¯è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œå› æ­¤å¦‚æœåœ¨ Render ä¸­ä½¿ç”¨å¢å¼ºå‡½æ•°ï¼Œå°±ä¼šå¯¼è‡´æ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“æ•´ä¸ªHOCï¼Œè€Œä¸”ä¹‹å‰çš„çŠ¶æ€ä¼šä¸¢å¤±ï¼›")])])])])])]),t._v(" "),n("h3",{attrs:{id:"_5-redux"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-redux"}},[t._v("#")]),t._v(" 5. Redux")]),t._v(" "),n("p",[t._v("Redux æ˜¯ä¸€ä¸ª "),n("strong",[t._v("æ•°æ®ç®¡ç†ä¸­å¿ƒ")]),t._v("ï¼Œå¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªå…¨å±€çš„ data store å®ä¾‹ã€‚å®ƒé€šè¿‡ä¸€å®šçš„ä½¿ç”¨è§„åˆ™å’Œé™åˆ¶ï¼Œä¿è¯ç€æ•°æ®çš„å¥å£®æ€§ã€å¯è¿½æº¯å’Œå¯é¢„æµ‹æ€§ã€‚å®ƒä¸ React æ— å…³ï¼Œå¯ä»¥ç‹¬ç«‹è¿è¡Œäºä»»ä½• JavaScript ç¯å¢ƒä¸­ï¼Œä»è€Œä¹Ÿä¸ºåŒæ„åº”ç”¨æä¾›äº†æ›´å¥½çš„æ•°æ®åŒæ­¥é€šé“ã€‚")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("æ ¸å¿ƒç†å¿µ")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("å•ä¸€æ•°æ®æº")]),t._v(": æ•´ä¸ªåº”ç”¨åªæœ‰å”¯ä¸€çš„çŠ¶æ€æ ‘ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰ state æœ€ç»ˆç»´æŠ¤åœ¨ä¸€ä¸ªæ ¹çº§ Store ä¸­ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("çŠ¶æ€åªè¯»")]),t._v(" "),n("p",[t._v(": ä¸ºäº†ä¿è¯çŠ¶æ€çš„å¯æ§æ€§ï¼Œæœ€å¥½çš„æ–¹å¼å°±æ˜¯ç›‘æ§çŠ¶æ€çš„å˜åŒ–ã€‚é‚£è¿™é‡Œå°±ä¸¤ä¸ªå¿…è¦æ¡ä»¶ï¼š")]),t._v(" "),n("ul",[n("li",[t._v("Redux Store ä¸­çš„æ•°æ®æ— æ³•è¢«ç›´æ¥ä¿®æ”¹ï¼›")]),t._v(" "),n("li",[t._v("ä¸¥æ ¼æ§åˆ¶ä¿®æ”¹çš„æ‰§è¡Œï¼›")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("çº¯å‡½æ•°")]),t._v(": è§„å®šåªèƒ½é€šè¿‡ä¸€ä¸ªçº¯å‡½æ•° (Reducer) æ¥æè¿°ä¿®æ”¹ï¼›")])])])]),t._v(" "),n("li",[n("p",[t._v("å¤§è‡´çš„æ•°æ®ç»“æ„å¦‚ä¸‹æ‰€ç¤º:")])])]),t._v(" "),n("p",[n("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/3/21/1699e0d09c40cec7~tplv-t2oaga2asx-watermark.awebp",alt:"img"}})]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("ç†å¿µå®ç°")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("Store")]),t._v(" "),n("p",[t._v(": å…¨å±€ Store å•ä¾‹ï¼Œ æ¯ä¸ª Redux åº”ç”¨ä¸‹åªæœ‰ä¸€ä¸ª storeï¼Œ å®ƒå…·æœ‰ä»¥ä¸‹æ–¹æ³•ä¾›ä½¿ç”¨:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("getState")]),t._v(": è·å– stateï¼›")]),t._v(" "),n("li",[n("code",[t._v("dispatch")]),t._v(": è§¦å‘ action, æ›´æ–° stateï¼›")]),t._v(" "),n("li",[n("code",[t._v("subscribe")]),t._v(": è®¢é˜…æ•°æ®å˜æ›´ï¼Œæ³¨å†Œç›‘å¬å™¨ï¼›")])])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// åˆ›å»º\nconst store = createStore(Reducer, initStore)\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("strong",[t._v("Action")]),t._v(": å®ƒä½œä¸ºä¸€ä¸ªè¡Œä¸ºè½½ä½“ï¼Œç”¨äºæ˜ å°„ç›¸åº”çš„ Reducerï¼Œå¹¶ä¸”å®ƒå¯ä»¥æˆä¸ºæ•°æ®çš„è½½ä½“ï¼Œå°†æ•°æ®ä»åº”ç”¨ä¼ é€’è‡³ store ä¸­ï¼Œæ˜¯ store "),n("strong",[t._v("å”¯ä¸€çš„æ•°æ®æº")]),t._v("ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// ä¸€ä¸ªæ™®é€šçš„ Action\nconst action = {\n\ttype: 'ADD_LIST',\n\titem: 'list-item-1',\n}\n\n// ä½¿ç”¨ï¼š\nstore.dispatch(action)\n\n// é€šå¸¸ä¸ºäº†ä¾¿äºè°ƒç”¨ï¼Œä¼šæœ‰ä¸€ä¸ª Action åˆ›å»ºå‡½æ•° (action creater)\nfuntion addList(item) {\n\treturn const action = {\n\t\ttype: 'ADD_LIST',\n\t\titem,\n\t}\n}\n\n// è°ƒç”¨å°±ä¼šå˜æˆ:\ndispatch(addList('list-item-1'))\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("strong",[t._v("Reducer")]),t._v(": ç”¨äºæè¿°å¦‚ä½•ä¿®æ”¹æ•°æ®çš„çº¯å‡½æ•°ï¼ŒAction å±äºè¡Œä¸ºåç§°ï¼Œè€Œ Reducer ä¾¿æ˜¯ä¿®æ”¹è¡Œä¸ºçš„å®è´¨ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// ä¸€ä¸ªå¸¸è§„çš„ Reducer\n// @param {state}: æ—§æ•°æ®\n// @param {action}: Action å¯¹è±¡\n// @returns {any}: æ–°æ•°æ®\nconst initList = []\nfunction ListReducer(state = initList, action) {\n\tswitch (action.type) {\n\t\tcase 'ADD_LIST':\n\t\t\treturn state.concat([action.item])\n\t\t\tbreak\n\t\tdefalut:\n\t\t\treturn state\n\t}\n}\nå¤åˆ¶ä»£ç \n")])])]),n("blockquote",[n("p",[n("strong",[t._v("æ³¨æ„")]),t._v(":")]),t._v(" "),n("ol",[n("li",[t._v("éµå®ˆæ•°æ®ä¸å¯å˜ï¼Œä¸è¦å»ç›´æ¥ä¿®æ”¹ stateï¼Œè€Œæ˜¯è¿”å›å‡ºä¸€ä¸ª "),n("strong",[t._v("æ–°å¯¹è±¡")]),t._v("ï¼Œå¯ä»¥ä½¿ç”¨ "),n("code",[t._v("assign / copy / extend / è§£æ„")]),t._v(" ç­‰æ–¹å¼åˆ›å»ºæ–°å¯¹è±¡ï¼›")]),t._v(" "),n("li",[t._v("é»˜è®¤æƒ…å†µä¸‹éœ€è¦ "),n("strong",[t._v("è¿”å›åŸæ•°æ®")]),t._v("ï¼Œé¿å…æ•°æ®è¢«æ¸…ç©ºï¼›")]),t._v(" "),n("li",[t._v("æœ€å¥½è®¾ç½® "),n("strong",[t._v("åˆå§‹å€¼")]),t._v("ï¼Œä¾¿äºåº”ç”¨çš„åˆå§‹åŒ–åŠæ•°æ®ç¨³å®šï¼›")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("è¿›é˜¶")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("React-Redux")]),t._v(" "),n("p",[t._v(": ç»“åˆ React ä½¿ç”¨ï¼›")]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("<Provider>")]),t._v(": å°† store é€šè¿‡ context ä¼ å…¥ç»„ä»¶ä¸­ï¼›")])]),t._v(" "),n("li",[n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("connect\n")])])]),n("p",[t._v(": ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå¯ä»¥æ–¹ä¾¿åœ¨ React ç»„ä»¶ä¸­ä½¿ç”¨ Reduxï¼›")]),t._v(" "),n("ul",[n("li",[n("ol",[n("li",[t._v("å°†"),n("code",[t._v("store")]),t._v("é€šè¿‡"),n("code",[t._v("mapStateToProps")]),t._v("è¿›è¡Œç­›é€‰åä½¿ç”¨"),n("code",[t._v("props")]),t._v("æ³¨å…¥ç»„ä»¶")])])]),t._v(" "),n("li",[n("ol",[n("li",[t._v("æ ¹æ®"),n("code",[t._v("mapDispatchToProps")]),t._v("åˆ›å»ºæ–¹æ³•ï¼Œå½“ç»„ä»¶è°ƒç”¨æ—¶ä½¿ç”¨"),n("code",[t._v("dispatch")]),t._v("è§¦å‘å¯¹åº”çš„"),n("code",[t._v("action")])])])])])])])]),t._v(" "),n("li",[n("p",[t._v("Reducer çš„æ‹†åˆ†ä¸é‡æ„")]),t._v(" "),n("p",[t._v(":")]),t._v(" "),n("ul",[n("li",[t._v("éšç€é¡¹ç›®è¶Šå¤§ï¼Œå¦‚æœå°†æ‰€æœ‰çŠ¶æ€çš„ reducer å…¨éƒ¨å†™åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå°†ä¼š "),n("strong",[t._v("éš¾ä»¥ç»´æŠ¤")]),t._v("ï¼›")]),t._v(" "),n("li",[t._v("å¯ä»¥å°† reducer è¿›è¡Œæ‹†åˆ†ï¼Œä¹Ÿå°±æ˜¯ "),n("strong",[t._v("å‡½æ•°åˆ†è§£")]),t._v("ï¼Œæœ€ç»ˆå†ä½¿ç”¨"),n("code",[t._v("combineReducers()")]),t._v("è¿›è¡Œé‡æ„åˆå¹¶ï¼›")])])]),t._v(" "),n("li",[n("p",[t._v("å¼‚æ­¥ Action")]),t._v(" "),n("p",[t._v(": ç”±äº Reducer æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„çº¯å‡½æ•°ï¼Œå› æ­¤æ— æ³•åœ¨ Reducer ä¸­è¿›è¡Œæ•°æ®çš„è¯·æ±‚ï¼Œéœ€è¦å…ˆè·å–æ•°æ®ï¼Œå†")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("dispatch(Action)\n")])])]),n("p",[t._v("å³å¯ï¼Œä¸‹é¢æ˜¯ä¸‰ç§ä¸åŒçš„å¼‚æ­¥å®ç°:")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Freduxjs%2Fredux-thunk",target:"_blank",rel:"noopener noreferrer"}},[t._v("redex-thunk"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fredux-saga%2Fredux-saga",target:"_blank",rel:"noopener noreferrer"}},[t._v("redux-saga"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fredux-observable%2Fredux-observable",target:"_blank",rel:"noopener noreferrer"}},[t._v("redux-observable"),n("OutboundLink")],1)])])])])])]),t._v(" "),n("h3",{attrs:{id:"_6-react-hooks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-react-hooks"}},[t._v("#")]),t._v(" 6. React Hooks")]),t._v(" "),n("p",[t._v("React ä¸­é€šå¸¸ä½¿ç”¨ "),n("strong",[t._v("ç±»å®šä¹‰")]),t._v(" æˆ–è€… "),n("strong",[t._v("å‡½æ•°å®šä¹‰")]),t._v(" åˆ›å»ºç»„ä»¶:")]),t._v(" "),n("p",[t._v("åœ¨ç±»å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ°è®¸å¤š React ç‰¹æ€§ï¼Œä¾‹å¦‚ stateã€ å„ç§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­ç­‰ï¼Œä½†æ˜¯åœ¨å‡½æ•°å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å´æ— èƒ½ä¸ºåŠ›ï¼Œå› æ­¤ React 16.8 ç‰ˆæœ¬æ¨å‡ºäº†ä¸€ä¸ªæ–°åŠŸèƒ½ (React Hooks)ï¼Œé€šè¿‡å®ƒï¼Œå¯ä»¥æ›´å¥½çš„åœ¨å‡½æ•°å®šä¹‰ç»„ä»¶ä¸­ä½¿ç”¨ React ç‰¹æ€§ã€‚")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("å¥½å¤„")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("1ã€"),n("strong",[t._v("è·¨ç»„ä»¶å¤ç”¨")]),t._v(": å…¶å® render props / HOC ä¹Ÿæ˜¯ä¸ºäº†å¤ç”¨ï¼Œç›¸æ¯”äºå®ƒä»¬ï¼ŒHooks ä½œä¸ºå®˜æ–¹çš„åº•å±‚ APIï¼Œæœ€ä¸ºè½»é‡ï¼Œè€Œä¸”æ”¹é€ æˆæœ¬å°ï¼Œä¸ä¼šå½±å“åŸæ¥çš„ç»„ä»¶å±‚æ¬¡ç»“æ„å’Œä¼ è¯´ä¸­çš„åµŒå¥—åœ°ç‹±ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("2ã€")]),t._v(" "),n("p",[t._v("ç±»å®šä¹‰æ›´ä¸ºå¤æ‚")]),t._v(" "),n("p",[t._v(":")]),t._v(" "),n("ul",[n("li",[t._v("ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸä¼šä½¿é€»è¾‘å˜å¾—åˆ†æ•£ä¸”æ··ä¹±ï¼Œä¸æ˜“ç»´æŠ¤å’Œç®¡ç†ï¼›")]),t._v(" "),n("li",[t._v("æ—¶åˆ»éœ€è¦å…³æ³¨"),n("code",[t._v("this")]),t._v("çš„æŒ‡å‘é—®é¢˜ï¼›")]),t._v(" "),n("li",[t._v("ä»£ç å¤ç”¨ä»£ä»·é«˜ï¼Œé«˜é˜¶ç»„ä»¶çš„ä½¿ç”¨ç»å¸¸ä¼šä½¿æ•´ä¸ªç»„ä»¶æ ‘å˜å¾—è‡ƒè‚¿ï¼›")])])]),t._v(" "),n("li",[n("p",[t._v("3ã€"),n("strong",[t._v("çŠ¶æ€ä¸UIéš”ç¦»")]),t._v(": æ­£æ˜¯ç”±äº Hooks çš„ç‰¹æ€§ï¼ŒçŠ¶æ€é€»è¾‘ä¼šå˜æˆæ›´å°çš„ç²’åº¦ï¼Œå¹¶ä¸”æå®¹æ˜“è¢«æŠ½è±¡æˆä¸€ä¸ªè‡ªå®šä¹‰ Hooksï¼Œç»„ä»¶ä¸­çš„çŠ¶æ€å’Œ UI å˜å¾—æ›´ä¸ºæ¸…æ™°å’Œéš”ç¦»ã€‚")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("æ³¨æ„")]),t._v(":")]),t._v(" "),n("ul",[n("li",[t._v("é¿å…åœ¨ å¾ªç¯/æ¡ä»¶åˆ¤æ–­/åµŒå¥—å‡½æ•° ä¸­è°ƒç”¨ hooksï¼Œä¿è¯è°ƒç”¨é¡ºåºçš„ç¨³å®šï¼›")]),t._v(" "),n("li",[t._v("åªæœ‰ å‡½æ•°å®šä¹‰ç»„ä»¶ å’Œ hooks å¯ä»¥è°ƒç”¨ hooksï¼Œé¿å…åœ¨ ç±»ç»„ä»¶ æˆ–è€… æ™®é€šå‡½æ•° ä¸­è°ƒç”¨ï¼›")]),t._v(" "),n("li",[t._v("ä¸èƒ½åœ¨"),n("code",[t._v("useEffect")]),t._v("ä¸­ä½¿ç”¨"),n("code",[t._v("useState")]),t._v("ï¼ŒReact ä¼šæŠ¥é”™æç¤ºï¼›")]),t._v(" "),n("li",[t._v("ç±»ç»„ä»¶ä¸ä¼šè¢«æ›¿æ¢æˆ–åºŸå¼ƒï¼Œä¸éœ€è¦å¼ºåˆ¶æ”¹é€ ç±»ç»„ä»¶ï¼Œä¸¤ç§æ–¹å¼èƒ½å¹¶å­˜ï¼›")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("é‡è¦é’©å­")]),t._v("*:")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("çŠ¶æ€é’©å­")]),t._v(" ("),n("code",[t._v("useState")]),t._v("): ç”¨äºå®šä¹‰ç»„ä»¶çš„ Stateï¼Œå…¶åˆ°ç±»å®šä¹‰ä¸­"),n("code",[t._v("this.state")]),t._v("çš„åŠŸèƒ½ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// useState åªæ¥å—ä¸€ä¸ªå‚æ•°: åˆå§‹çŠ¶æ€\n// è¿”å›çš„æ˜¯ç»„ä»¶åå’Œæ›´æ”¹è¯¥ç»„ä»¶å¯¹åº”çš„å‡½æ•°\nconst [flag, setFlag] = useState(true);\n// ä¿®æ”¹çŠ¶æ€\nsetFlag(false)\n\t\n// ä¸Šé¢çš„ä»£ç æ˜ å°„åˆ°ç±»å®šä¹‰ä¸­:\nthis.state = {\n\tflag: true\t\n}\nconst flag = this.state.flag\nconst setFlag = (bool) => {\n    this.setState({\n        flag: bool,\n    })\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("strong",[t._v("ç”Ÿå‘½å‘¨æœŸé’©å­")]),t._v(" ("),n("code",[t._v("useEffect")]),t._v("):")])]),t._v(" "),n("p",[t._v("ç±»å®šä¹‰ä¸­æœ‰è®¸å¤šç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè€Œåœ¨ React Hooks ä¸­ä¹Ÿæä¾›äº†ä¸€ä¸ªç›¸åº”çš„å‡½æ•° ("),n("code",[t._v("useEffect")]),t._v(")ï¼Œè¿™é‡Œå¯ä»¥çœ‹åš"),n("code",[t._v("componentDidMount")]),t._v("ã€"),n("code",[t._v("componentDidUpdate")]),t._v("å’Œ"),n("code",[t._v("componentWillUnmount")]),t._v("çš„ç»“åˆã€‚")]),t._v(" "),n("ul",[n("li",[n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("useEffect(callback, [source])\n")])])]),n("p",[t._v("æ¥å—ä¸¤ä¸ªå‚æ•°")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("callback")]),t._v(": é’©å­å›è°ƒå‡½æ•°ï¼›")]),t._v(" "),n("li",[n("code",[t._v("source")]),t._v(": è®¾ç½®è§¦å‘æ¡ä»¶ï¼Œä»…å½“ source å‘ç”Ÿæ”¹å˜æ—¶æ‰ä¼šè§¦å‘ï¼›")]),t._v(" "),n("li",[n("code",[t._v("useEffect")]),t._v("é’©å­åœ¨æ²¡æœ‰ä¼ å…¥"),n("code",[t._v("[source]")]),t._v("å‚æ•°æ—¶ï¼Œé»˜è®¤åœ¨æ¯æ¬¡ render æ—¶éƒ½ä¼šä¼˜å…ˆè°ƒç”¨ä¸Šæ¬¡ä¿å­˜çš„å›è°ƒä¸­è¿”å›çš„å‡½æ•°ï¼Œåå†é‡æ–°è°ƒç”¨å›è°ƒï¼›")])])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("useEffect(() => {\n\t// ç»„ä»¶æŒ‚è½½åæ‰§è¡Œäº‹ä»¶ç»‘å®š\n\tconsole.log('on')\n\taddEventListener()\n\t\n\t// ç»„ä»¶ update æ—¶ä¼šæ‰§è¡Œäº‹ä»¶è§£ç»‘\n\treturn () => {\n\t\tconsole.log('off')\n\t\tremoveEventListener()\n\t}\n}, [source]);\n\n\n// æ¯æ¬¡ source å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰§è¡Œç»“æœ(ä»¥ç±»å®šä¹‰çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¾¿äºå¤§å®¶ç†è§£):\n// --- DidMount ---\n// 'on'\n// --- DidUpdate ---\n// 'off'\n// 'on'\n// --- DidUpdate ---\n// 'off'\n// 'on'\n// --- WillUnmount --- \n// 'off'\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("p",[t._v("é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ä¾¿å¯æ¨¡æ‹Ÿå‡ºå‡ ä¸ªå¸¸ç”¨çš„ç”Ÿå‘½å‘¨æœŸ:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("componentDidMount")]),t._v(": ä¼ å…¥"),n("code",[t._v("[]")]),t._v("æ—¶ï¼Œå°±åªä¼šåœ¨åˆå§‹åŒ–æ—¶è°ƒç”¨ä¸€æ¬¡ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("const useMount = (fn) => useEffect(fn, [])\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("code",[t._v("componentWillUnmount")]),t._v(": ä¼ å…¥"),n("code",[t._v("[]")]),t._v("ï¼Œå›è°ƒä¸­çš„è¿”å›çš„å‡½æ•°ä¹Ÿåªä¼šè¢«æœ€ç»ˆæ‰§è¡Œä¸€æ¬¡ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("const useUnmount = (fn) => useEffect(() => fn, [])\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("code",[t._v("mounted")]),t._v(": å¯ä»¥ä½¿ç”¨ useState å°è£…æˆä¸€ä¸ªé«˜åº¦å¯å¤ç”¨çš„ mounted çŠ¶æ€ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("const useMounted = () => {\n    const [mounted, setMounted] = useState(false);\n    useEffect(() => {\n        !mounted && setMounted(true);\n        return () => setMounted(false);\n    }, []);\n    return mounted;\n}\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("code",[t._v("componentDidUpdate")]),t._v(": "),n("code",[t._v("useEffect")]),t._v("æ¯æ¬¡å‡ä¼šæ‰§è¡Œï¼Œå…¶å®å°±æ˜¯æ’é™¤äº† DidMount åå³å¯ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("const mounted = useMounted() \nuseEffect(() => {\n    mounted && fn()\n})\nå¤åˆ¶ä»£ç \n")])])])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("å…¶å®ƒå†…ç½®é’©å­")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("useContext")]),t._v(": è·å– context å¯¹è±¡")]),t._v(" "),n("li",[n("code",[t._v("useReducer")]),t._v(": ç±»ä¼¼äº Redux æ€æƒ³çš„å®ç°ï¼Œä½†å…¶å¹¶ä¸è¶³ä»¥æ›¿ä»£ Reduxï¼Œå¯ä»¥ç†è§£æˆä¸€ä¸ªç»„ä»¶å†…éƒ¨çš„ redux:\n"),n("ul",[n("li",[t._v("å¹¶ä¸æ˜¯æŒä¹…åŒ–å­˜å‚¨ï¼Œä¼šéšç€ç»„ä»¶è¢«é”€æ¯è€Œé”€æ¯ï¼›")]),t._v(" "),n("li",[t._v("å±äºç»„ä»¶å†…éƒ¨ï¼Œå„ä¸ªç»„ä»¶æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œå•çº¯ç”¨å®ƒå¹¶æ— æ³•å…±äº«æ•°æ®ï¼›")]),t._v(" "),n("li",[t._v("é…åˆ"),n("code",[t._v("useContext")]),t._v("çš„å…¨å±€æ€§ï¼Œå¯ä»¥å®Œæˆä¸€ä¸ªè½»é‡çº§çš„ Reduxï¼›("),n("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fctrlplusb%2Feasy-peasy",target:"_blank",rel:"noopener noreferrer"}},[t._v("easy-peasy"),n("OutboundLink")],1),t._v(")")])])]),t._v(" "),n("li",[n("code",[t._v("useCallback")]),t._v(": ç¼“å­˜å›è°ƒå‡½æ•°ï¼Œé¿å…ä¼ å…¥çš„å›è°ƒæ¯æ¬¡éƒ½æ˜¯æ–°çš„å‡½æ•°å®ä¾‹è€Œå¯¼è‡´ä¾èµ–ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œå…·æœ‰æ€§èƒ½ä¼˜åŒ–çš„æ•ˆæœï¼›")]),t._v(" "),n("li",[n("code",[t._v("useMemo")]),t._v(": ç”¨äºç¼“å­˜ä¼ å…¥çš„ propsï¼Œé¿å…ä¾èµ–çš„ç»„ä»¶æ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“ï¼›")]),t._v(" "),n("li",[n("code",[t._v("useRef")]),t._v(": è·å–ç»„ä»¶çš„çœŸå®èŠ‚ç‚¹ï¼›")]),t._v(" "),n("li",[n("code",[t._v("useLayoutEffect")]),t._v(":\n"),n("ul",[n("li",[t._v("DOMæ›´æ–°åŒæ­¥é’©å­ã€‚ç”¨æ³•ä¸"),n("code",[t._v("useEffect")]),t._v("ç±»ä¼¼ï¼Œåªæ˜¯åŒºåˆ«äºæ‰§è¡Œæ—¶é—´ç‚¹çš„ä¸åŒã€‚")]),t._v(" "),n("li",[n("code",[t._v("useEffect")]),t._v("å±äºå¼‚æ­¥æ‰§è¡Œï¼Œå¹¶ä¸ä¼šç­‰å¾… DOM çœŸæ­£æ¸²æŸ“åæ‰§è¡Œï¼Œè€Œ"),n("code",[t._v("useLayoutEffect")]),t._v("åˆ™ä¼šçœŸæ­£æ¸²æŸ“åæ‰è§¦å‘ï¼›")]),t._v(" "),n("li",[t._v("å¯ä»¥è·å–æ›´æ–°åçš„ stateï¼›")])])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("è‡ªå®šä¹‰é’©å­")]),t._v("("),n("code",[t._v("useXxxxx")]),t._v("): åŸºäº Hooks å¯ä»¥å¼•ç”¨å…¶å®ƒ Hooks è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è‡ªå®šä¹‰é’©å­ï¼Œå¦‚ä¸Šé¢çš„"),n("code",[t._v("useMounted")]),t._v("ã€‚åˆä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦æ¯ä¸ªé¡µé¢è‡ªå®šä¹‰æ ‡é¢˜:")])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function useTitle(title) {\n  useEffect(\n    () => {\n      document.title = title;\n    });\n}\n\n// ä½¿ç”¨:\nfunction Home() {\n\tconst title = 'æˆ‘æ˜¯é¦–é¡µ'\n\tuseTitle(title)\n\t\n\treturn (\n\t\t<div>{title}</div>\n\t)\n}\nå¤åˆ¶ä»£ç \n")])])]),n("h3",{attrs:{id:"_7-ssr"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-ssr"}},[t._v("#")]),t._v(" 7. SSR")]),t._v(" "),n("p",[t._v("SSRï¼Œä¿—ç§° "),n("strong",[t._v("æœåŠ¡ç«¯æ¸²æŸ“")]),t._v(" (Server Side Render)ï¼Œè®²äººè¯å°±æ˜¯: ç›´æ¥åœ¨æœåŠ¡ç«¯å±‚è·å–æ•°æ®ï¼Œæ¸²æŸ“å‡ºå®Œæˆçš„ HTML æ–‡ä»¶ï¼Œç›´æ¥è¿”å›ç»™ç”¨æˆ·æµè§ˆå™¨è®¿é—®ã€‚")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("å‰åç«¯åˆ†ç¦»")]),t._v(": å‰ç«¯ä¸æœåŠ¡ç«¯éš”ç¦»ï¼Œå‰ç«¯åŠ¨æ€è·å–æ•°æ®ï¼Œæ¸²æŸ“é¡µé¢ã€‚")]),t._v(" "),n("li",[n("strong",[t._v("ç—›ç‚¹")]),t._v(":\n"),n("ul",[n("li",[n("strong",[t._v("é¦–å±æ¸²æŸ“æ€§èƒ½ç“¶é¢ˆ")]),t._v(":\n"),n("ul",[n("li",[t._v("ç©ºç™½å»¶è¿Ÿ: HTMLä¸‹è½½æ—¶é—´ + JSä¸‹è½½/æ‰§è¡Œæ—¶é—´ + è¯·æ±‚æ—¶é—´ + æ¸²æŸ“æ—¶é—´ã€‚åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œé¡µé¢å¤„äºç©ºç™½çš„çŠ¶æ€ã€‚")])])]),t._v(" "),n("li",[n("strong",[t._v("SEO é—®é¢˜")]),t._v(": ç”±äºé¡µé¢åˆå§‹çŠ¶æ€ä¸ºç©ºï¼Œå› æ­¤çˆ¬è™«æ— æ³•è·å–é¡µé¢ä¸­ä»»ä½•æœ‰æ•ˆæ•°æ®ï¼Œå› æ­¤å¯¹æœç´¢å¼•æ“ä¸å‹å¥½ã€‚\n"),n("ul",[n("li",[t._v("è™½ç„¶ä¸€ç›´æœ‰åœ¨æåŠ¨æ€æ¸²æŸ“çˆ¬è™«çš„æŠ€æœ¯ï¼Œä¸è¿‡æ®æˆ‘äº†è§£ï¼Œå¤§éƒ¨åˆ†å›½å†…æœç´¢å¼•æ“ä»ç„¶æ˜¯æ²¡æœ‰å®ç°ã€‚")])])])])])]),t._v(" "),n("p",[t._v("æœ€åˆçš„æœåŠ¡ç«¯æ¸²æŸ“ï¼Œä¾¿æ²¡æœ‰è¿™äº›é—®é¢˜ã€‚ä½†æˆ‘ä»¬ä¸èƒ½è¿”ç’å½’çœŸï¼Œæ—¢è¦ä¿è¯ç°æœ‰çš„å‰ç«¯ç‹¬ç«‹çš„å¼€å‘æ¨¡å¼ï¼Œåˆè¦ç”±æœåŠ¡ç«¯æ¸²æŸ“ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨ React SSRã€‚")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("åŸç†")]),t._v(":\n"),n("ul",[n("li",[t._v("Node æœåŠ¡: è®©å‰åç«¯è¿è¡ŒåŒä¸€å¥—ä»£ç æˆä¸ºå¯èƒ½ã€‚")]),t._v(" "),n("li",[t._v("Virtual Dom: è®©å‰ç«¯ä»£ç è„±ç¦»æµè§ˆå™¨è¿è¡Œã€‚")])])]),t._v(" "),n("li",[n("strong",[t._v("æ¡ä»¶")]),t._v(": Node ä¸­é—´å±‚ã€ React / Vue ç­‰æ¡†æ¶ã€‚ ç»“æ„å¤§æ¦‚å¦‚ä¸‹:")])]),t._v(" "),n("p",[n("img",{attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/3/21/1699e0d41797a4d1~tplv-t2oaga2asx-watermark.awebp",alt:"img"}})]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("å¼€å‘æµç¨‹")]),t._v(": (æ­¤å¤„ä»¥ React + Router + Redux + Koa ä¸ºä¾‹)")]),t._v(" "),n("ul",[n("li",[t._v("1ã€åœ¨åŒä¸ªé¡¹ç›®ä¸­ï¼Œ"),n("strong",[t._v("æ­å»º")]),t._v(" å‰åç«¯éƒ¨åˆ†ï¼Œå¸¸è§„ç»“æ„:\n"),n("ul",[n("li",[t._v("build")]),t._v(" "),n("li",[t._v("public")]),t._v(" "),n("li",[t._v("src\n"),n("ul",[n("li",[t._v("client")]),t._v(" "),n("li",[t._v("server")])])])])]),t._v(" "),n("li",[t._v("2ã€server ä¸­ä½¿ç”¨ Koa "),n("strong",[t._v("è·¯ç”±ç›‘å¬")]),t._v(" é¡µé¢è®¿é—®:")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("import * as Router from 'koa-router'\n\nconst router = new Router()\n// å¦‚æœä¸­é—´ä¹Ÿæä¾› Api å±‚\nrouter.use('/api/home', async () => {\n\t// è¿”å›æ•°æ®\n})\n\nrouter.get('*', async (ctx) => {\n\t// è¿”å› HTML\n})\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[t._v("3ã€é€šè¿‡è®¿é—® url "),n("strong",[t._v("åŒ¹é…")]),t._v(" å‰ç«¯é¡µé¢è·¯ç”±:")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// å‰ç«¯é¡µé¢è·¯ç”±\nimport { pages } from '../../client/app'\nimport { matchPath } from 'react-router-dom'\n\n// ä½¿ç”¨ react-router åº“æä¾›çš„ä¸€ä¸ªåŒ¹é…æ–¹æ³•\nconst matchPage = matchPath(ctx.req.url, page)\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("p",[t._v("4ã€é€šè¿‡é¡µé¢è·¯ç”±çš„é…ç½®è¿›è¡Œ "),n("strong",[t._v("æ•°æ®è·å–")]),t._v("ã€‚é€šå¸¸å¯ä»¥åœ¨é¡µé¢è·¯ç”±ä¸­å¢åŠ  SSR ç›¸å…³çš„é™æ€é…ç½®ï¼Œç”¨äºæŠ½è±¡é€»è¾‘ï¼Œå¯ä»¥ä¿è¯æœåŠ¡ç«¯é€»è¾‘çš„é€šç”¨æ€§ï¼Œå¦‚:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("class HomePage extends React.Component{\n\tpublic static ssrConfig = {\n\t\t  cache: true,\n         fetch() {\n        \t  // è¯·æ±‚è·å–æ•°æ®\n         }\n    }\n}\nå¤åˆ¶ä»£ç \n")])])]),n("p",[t._v("è·å–æ•°æ®é€šå¸¸æœ‰ä¸¤ç§æƒ…å†µ:")]),t._v(" "),n("ul",[n("li",[t._v("ä¸­é—´å±‚ä¹Ÿä½¿ç”¨ "),n("strong",[t._v("http")]),t._v(" è·å–æ•°æ®ï¼Œåˆ™æ­¤æ—¶ fetch æ–¹æ³•å¯å‰åç«¯å…±äº«ï¼›")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("const data = await matchPage.ssrConfig.fetch()\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[t._v("ä¸­é—´å±‚å¹¶ä¸ä½¿ç”¨ httpï¼Œæ˜¯é€šè¿‡ä¸€äº› "),n("strong",[t._v("å†…éƒ¨è°ƒç”¨")]),t._v("ï¼Œä¾‹å¦‚ Rpc æˆ– ç›´æ¥è¯»æ•°æ®åº“ ç­‰ï¼Œæ­¤æ—¶ä¹Ÿå¯ä»¥ç›´æ¥ç”±æœåŠ¡ç«¯è°ƒç”¨å¯¹åº”çš„æ–¹æ³•è·å–æ•°æ®ã€‚é€šå¸¸ï¼Œè¿™é‡Œéœ€è¦åœ¨ ssrConfig ä¸­é…ç½®ç‰¹å¼‚æ€§çš„ä¿¡æ¯ï¼Œç”¨äºåŒ¹é…å¯¹åº”çš„æ•°æ®è·å–æ–¹æ³•ã€‚")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// é¡µé¢è·¯ç”±\nclass HomePage extends React.Component{\n\tpublic static ssrConfig = {\n        fetch: {\n        \t url: '/api/home',\n        }\n    }\n}\n\n// æ ¹æ®è§„åˆ™åŒ¹é…å‡ºå¯¹åº”çš„æ•°æ®è·å–æ–¹æ³•\n// è¿™é‡Œçš„è§„åˆ™å¯ä»¥è‡ªç”±ï¼Œåªè¦èƒ½åŒ¹é…å‡ºæ­£ç¡®çš„æ–¹æ³•å³å¯\nconst controller = matchController(ssrConfig.fetch.url)\n\n// è·å–æ•°æ®\nconst data = await controller(ctx)\nå¤åˆ¶ä»£ç \n")])])])]),t._v(" "),n("li",[n("p",[t._v("5ã€åˆ›å»º Redux storeï¼Œå¹¶å°†æ•°æ®"),n("code",[t._v("dispatch")]),t._v("åˆ°é‡Œé¢:")])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("import { createStore } from 'redux'\n// è·å– Clinetå±‚ reducer\n// å¿…é¡»å¤ç”¨å‰ç«¯å±‚çš„é€»è¾‘ï¼Œæ‰èƒ½ä¿è¯ä¸€è‡´æ€§ï¼›\nimport { reducers } from '../../client/store'\n\n// åˆ›å»º store\nconst store = createStore(reducers)\n \n// è·å–é…ç½®å¥½çš„ Action\nconst action = ssrConfig.action\n\n// å­˜å‚¨æ•°æ®\t\nstore.dispatch(createAction(action)(data))\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[t._v("6ã€æ³¨å…¥ Storeï¼Œ è°ƒç”¨"),n("code",[t._v("renderToString")]),t._v("å°† React Virtual Dom æ¸²æŸ“æˆ "),n("strong",[t._v("å­—ç¬¦ä¸²")]),t._v(":")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("import * as ReactDOMServer from 'react-dom/server'\nimport { Provider } from 'react-redux'\n\n// è·å– Clinet å±‚æ ¹ç»„ä»¶\nimport { App } from '../../client/app'\n\nconst AppString = ReactDOMServer.renderToString(\n\t<Provider store={store}>\n\t\t<StaticRouter\n\t\t\tlocation={ctx.req.url}\n\t\t\tcontext={{}}>\n\t\t\t<App />\n\t\t</StaticRouter>\n\t</Provider>\n)\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[t._v("7ã€å°† AppString åŒ…è£…æˆå®Œæ•´çš„ html æ–‡ä»¶æ ¼å¼ï¼›")]),t._v(" "),n("li",[t._v("8ã€æ­¤æ—¶ï¼Œå·²ç»èƒ½ç”Ÿæˆå®Œæ•´çš„ HTML æ–‡ä»¶ã€‚ä½†åªæ˜¯ä¸ªçº¯é™æ€çš„é¡µé¢ï¼Œæ²¡æœ‰æ ·å¼æ²¡æœ‰äº¤äº’ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ˜¯è¦æ’å…¥ JS ä¸ CSSã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—®å‰ç«¯æ‰“åŒ…åç”Ÿæˆçš„"),n("code",[t._v("asset-manifest.json")]),t._v("æ–‡ä»¶æ¥è·å–ç›¸åº”çš„æ–‡ä»¶è·¯å¾„ï¼Œå¹¶åŒæ ·æ³¨å…¥åˆ° Html ä¸­å¼•ç”¨ã€‚")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('const html = `\n\t<!DOCTYPE html>\n\t<html lang="zh">\n\t\t<head></head>\n\t\t<link href="${cssPath}" rel="stylesheet" />\n\t\t<body>\n\t\t\t<div id="App">${AppString}</div>\n\t\t\t<script src="${scriptPath}"><\/script>\n\t\t</body>\n\t</html>\n`\nå¤åˆ¶ä»£ç \n')])])]),n("ul",[n("li",[t._v("9ã€è¿›è¡Œ "),n("strong",[t._v("æ•°æ®è„±æ°´")]),t._v(": ä¸ºäº†æŠŠæœåŠ¡ç«¯è·å–çš„æ•°æ®åŒæ­¥åˆ°å‰ç«¯ã€‚ä¸»è¦æ˜¯å°†æ•°æ®åºåˆ—åŒ–åï¼Œæ’å…¥åˆ° html ä¸­ï¼Œè¿”å›ç»™å‰ç«¯ã€‚")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('import serialize from \'serialize-javascript\'\n// è·å–æ•°æ®\nconst initState = store.getState()\nconst html = `\n\t<!DOCTYPE html>\n\t<html lang="zh">\n\t\t<head></head>\n\t\t<body>\n\t\t\t<div id="App"></div>\n\t\t\t<script type="application/json" id="SSR_HYDRATED_DATA">${serialize(initState)}<\/script>\n\t\t</body>\n\t</html>\n`\n\nctx.status = 200\nctx.body = html\nå¤åˆ¶ä»£ç \n')])])]),n("blockquote",[n("p",[n("strong",[t._v("Tips")]),t._v(":")]),t._v(" "),n("p",[t._v("è¿™é‡Œæ¯”è¾ƒç‰¹åˆ«çš„æœ‰ä¸¤ç‚¹:")]),t._v(" "),n("ol",[n("li",[t._v("ä½¿ç”¨äº†"),n("code",[t._v("serialize-javascript")]),t._v("åºåˆ—åŒ– storeï¼Œ æ›¿ä»£äº†"),n("code",[t._v("JSON.stringify")]),t._v("ï¼Œä¿è¯æ•°æ®çš„å®‰å…¨æ€§ï¼Œé¿å…ä»£ç æ³¨å…¥å’Œ XSS æ”»å‡»ï¼›")]),t._v(" "),n("li",[t._v("ä½¿ç”¨ json è¿›è¡Œä¼ è¾“ï¼Œå¯ä»¥è·å¾—æ›´å¿«çš„åŠ è½½é€Ÿåº¦ï¼›")])])]),t._v(" "),n("ul",[n("li",[t._v("10ã€Client å±‚ "),n("strong",[t._v("æ•°æ®å¸æ°´")]),t._v(": åˆå§‹åŒ– store æ—¶ï¼Œä»¥è„±æ°´åçš„æ•°æ®ä¸ºåˆå§‹åŒ–æ•°æ®ï¼ŒåŒæ­¥åˆ›å»º storeã€‚")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("const hydratedEl = document.getElementById('SSR_HYDRATED_DATA')\nconst hydrateData = JSON.parse(hydratedEl.textContent)\n\n// ä½¿ç”¨åˆå§‹ state åˆ›å»º Redux store\nconst store = createStore(reducer, hydrateData)\nå¤åˆ¶ä»£ç \n")])])])])]),t._v(" "),n("h3",{attrs:{id:"_8-å‡½æ•°å¼ç¼–ç¨‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-å‡½æ•°å¼ç¼–ç¨‹"}},[t._v("#")]),t._v(" 8. å‡½æ•°å¼ç¼–ç¨‹")]),t._v(" "),n("p",[t._v("å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ "),n("strong",[t._v("ç¼–ç¨‹èŒƒå¼")]),t._v("ï¼Œä½ å¯ä»¥ç†è§£ä¸ºä¸€ç§è½¯ä»¶æ¶æ„çš„æ€ç»´æ¨¡å¼ã€‚å®ƒæœ‰ç€ç‹¬ç«‹ä¸€å¥—ç†è®ºåŸºç¡€ä¸è¾¹ç•Œæ³•åˆ™ï¼Œè¿½æ±‚çš„æ˜¯ "),n("strong",[t._v("æ›´ç®€æ´ã€å¯é¢„æµ‹ã€é«˜å¤ç”¨ã€æ˜“æµ‹è¯•")]),t._v("ã€‚å…¶å®åœ¨ç°æœ‰çš„ä¼—å¤šçŸ¥ååº“ä¸­ï¼Œéƒ½è•´å«ç€ä¸°å¯Œçš„å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼Œå¦‚ React / Redux ç­‰ã€‚")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("å¸¸è§çš„ç¼–ç¨‹èŒƒå¼")]),t._v(":")]),t._v(" "),n("ul",[n("li",[t._v("å‘½ä»¤å¼ç¼–ç¨‹(è¿‡ç¨‹åŒ–ç¼–ç¨‹): æ›´å…³å¿ƒè§£å†³é—®é¢˜çš„æ­¥éª¤ï¼Œä¸€æ­¥æ­¥ä»¥è¯­è¨€çš„å½¢å¼å‘Šè¯‰è®¡ç®—æœºåšä»€ä¹ˆï¼›")]),t._v(" "),n("li",[t._v("äº‹ä»¶é©±åŠ¨ç¼–ç¨‹: äº‹ä»¶è®¢é˜…ä¸è§¦å‘ï¼Œè¢«å¹¿æ³›ç”¨äº GUI çš„ç¼–ç¨‹è®¾è®¡ä¸­ï¼›")]),t._v(" "),n("li",[t._v("é¢å‘å¯¹è±¡ç¼–ç¨‹: åŸºäºç±»ã€å¯¹è±¡ä¸æ–¹æ³•çš„è®¾è®¡æ¨¡å¼ï¼Œæ‹¥æœ‰ä¸‰ä¸ªåŸºç¡€æ¦‚å¿µ: å°è£…æ€§ã€ç»§æ‰¿æ€§ã€å¤šæ€æ€§ï¼›")]),t._v(" "),n("li",[t._v("å‡½æ•°å¼ç¼–ç¨‹\n"),n("ul",[n("li",[t._v("æ¢æˆä¸€ç§æ›´é«˜ç«¯çš„è¯´æ³•ï¼Œé¢å‘æ•°å­¦ç¼–ç¨‹ã€‚æ€•ä¸æ€•~ğŸ¥´")])])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("å‡½æ•°å¼ç¼–ç¨‹çš„ç†å¿µ")]),t._v(":")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("çº¯å‡½æ•°")]),t._v("(ç¡®å®šæ€§å‡½æ•°): æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„åŸºç¡€ï¼Œå¯ä»¥ä½¿ç¨‹åºå˜å¾—çµæ´»ï¼Œé«˜åº¦å¯æ‹“å±•ï¼Œå¯ç»´æŠ¤ï¼›")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("ä¼˜åŠ¿")]),t._v(":\n"),n("ul",[n("li",[t._v("å®Œå…¨ç‹¬ç«‹ï¼Œä¸å¤–éƒ¨è§£è€¦ï¼›")]),t._v(" "),n("li",[t._v("é«˜åº¦å¯å¤ç”¨ï¼Œåœ¨ä»»æ„ä¸Šä¸‹æ–‡ï¼Œä»»æ„æ—¶é—´çº¿ä¸Šï¼Œéƒ½å¯æ‰§è¡Œå¹¶ä¸”ä¿è¯ç»“æœç¨³å®šï¼›")]),t._v(" "),n("li",[t._v("å¯æµ‹è¯•æ€§æå¼ºï¼›")])])]),t._v(" "),n("li",[n("strong",[t._v("æ¡ä»¶")]),t._v(":\n"),n("ul",[n("li",[t._v("ä¸ä¿®æ”¹å‚æ•°ï¼›")]),t._v(" "),n("li",[t._v("ä¸ä¾èµ–ã€ä¸ä¿®æ”¹ä»»ä½•å‡½æ•°å¤–éƒ¨çš„æ•°æ®ï¼›")]),t._v(" "),n("li",[t._v("å®Œå…¨å¯æ§ï¼Œå‚æ•°ä¸€æ ·ï¼Œè¿”å›å€¼ä¸€å®šä¸€æ ·: ä¾‹å¦‚å‡½æ•°ä¸èƒ½åŒ…å«"),n("code",[t._v("new Date()")]),t._v("æˆ–è€…"),n("code",[t._v("Math.rando()")]),t._v("ç­‰è¿™ç§ä¸å¯æ§å› ç´ ï¼›")]),t._v(" "),n("li",[t._v("å¼•ç”¨é€æ˜ï¼›")])])]),t._v(" "),n("li",[t._v("æˆ‘ä»¬å¸¸ç”¨åˆ°çš„è®¸å¤š API æˆ–è€…å·¥å…·å‡½æ•°ï¼Œå®ƒä»¬éƒ½å…·æœ‰ç€çº¯å‡½æ•°çš„ç‰¹ç‚¹ï¼Œ å¦‚"),n("code",[t._v("split / join / map")]),t._v("ï¼›")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("å‡½æ•°å¤åˆ")]),t._v(": å°†å¤šä¸ªå‡½æ•°è¿›è¡Œç»„åˆåè°ƒç”¨ï¼Œå¯ä»¥å®ç°å°†ä¸€ä¸ªä¸ªå‡½æ•°å•å…ƒè¿›è¡Œç»„åˆï¼Œè¾¾æˆæœ€åçš„ç›®æ ‡ï¼›")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("æ‰å¹³åŒ–åµŒå¥—")]),t._v(": é¦–å…ˆï¼Œæˆ‘ä»¬ä¸€å®šèƒ½æƒ³åˆ°ç»„åˆå‡½æ•°æœ€ç®€å•çš„æ“ä½œå°±æ˜¯ åŒ…è£¹ï¼Œå› ä¸ºåœ¨ JS ä¸­ï¼Œå‡½æ•°ä¹Ÿå¯ä»¥å½“åšå‚æ•°:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("f(g(k(x)))")]),t._v(": åµŒå¥—åœ°ç‹±ï¼Œå¯è¯»æ€§ä½ï¼Œå½“å‡½æ•°å¤æ‚åï¼Œå®¹æ˜“è®©äººä¸€è„¸æ‡µé€¼ï¼›")]),t._v(" "),n("li",[t._v("ç†æƒ³çš„åšæ³•: "),n("code",[t._v("xxx(f, g, k)(x)")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("ç»“æœä¼ é€’")]),t._v(": å¦‚æœæƒ³å®ç°ä¸Šé¢çš„æ–¹å¼ï¼Œé‚£ä¹Ÿå°±æ˜¯"),n("code",[t._v("xxx")]),t._v("å‡½æ•°è¦å®ç°çš„ä¾¿æ˜¯: æ‰§è¡Œç»“æœåœ¨å„ä¸ªå‡½æ•°ä¹‹é—´çš„æ‰§è¡Œä¼ é€’ï¼›")]),t._v(" "),n("ul",[n("li",[t._v("è¿™æ—¶æˆ‘ä»¬å°±èƒ½æƒ³åˆ°ä¸€ä¸ªåŸç”Ÿæä¾›çš„æ•°ç»„æ–¹æ³•: "),n("code",[t._v("reduce")]),t._v("ï¼Œå®ƒå¯ä»¥æŒ‰æ•°ç»„çš„é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œä¼ é€’æ‰§è¡Œç»“æœï¼›")]),t._v(" "),n("li",[t._v("æ‰€ä»¥æˆ‘ä»¬å°±èƒ½å¤Ÿå®ç°ä¸€ä¸ªæ–¹æ³•"),n("code",[t._v("pipe")]),t._v("ï¼Œç”¨äºå‡½æ•°ç»„åˆ:")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// ...fs: å°†å‡½æ•°ç»„åˆæˆæ•°ç»„ï¼›\n// Array.prototype.reduce è¿›è¡Œç»„åˆï¼›\n// p: åˆå§‹å‚æ•°ï¼›\nconst pipe = (...fs) => p => fs.reduce((v, f) => f(v), p)\nå¤åˆ¶ä»£ç \n")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("ä½¿ç”¨")]),t._v(": å®ç°ä¸€ä¸ª é©¼å³°å‘½å è½¬ ä¸­åˆ’çº¿å‘½å çš„åŠŸèƒ½:")])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("// 'Guo DongDong' --\x3e 'guo-dongdong'\n// å‡½æ•°ç»„åˆå¼å†™æ³•\nconst toLowerCase = str => str.toLowerCase()\nconst join = curry((str, arr) => arr.join(str))\nconst split = curry((splitOn, str) => str.split(splitOn));\n\nconst toSlug = pipe(\n\ttoLowerCase,\t\n\tsplit(' '),\n\tjoin('_'),\n\tencodeURIComponent,\n);\nconsole.log(toSlug('Guo DongDong'))\nå¤åˆ¶ä»£ç \n")])])]),n("ul",[n("li",[n("p",[n("strong",[t._v("å¥½å¤„")]),t._v(":")]),t._v(" "),n("ul",[n("li",[t._v("éšè—ä¸­é—´å‚æ•°ï¼Œä¸éœ€è¦ä¸´æ—¶å˜é‡ï¼Œé¿å…äº†è¿™ä¸ªç¯èŠ‚çš„å‡ºé”™å‡ ç‡ï¼›")]),t._v(" "),n("li",[t._v("åªéœ€å…³æ³¨æ¯ä¸ªçº¯å‡½æ•°å•å…ƒçš„ç¨³å®šï¼Œä¸å†éœ€è¦å…³æ³¨å‘½åï¼Œä¼ é€’ï¼Œè°ƒç”¨ç­‰ï¼›")]),t._v(" "),n("li",[t._v("å¯å¤ç”¨æ€§å¼ºï¼Œä»»ä½•ä¸€ä¸ªå‡½æ•°å•å…ƒéƒ½å¯è¢«ä»»æ„å¤ç”¨å’Œç»„åˆï¼›")]),t._v(" "),n("li",[t._v("å¯æ‹“å±•æ€§å¼ºï¼Œæˆæœ¬ä½ï¼Œä¾‹å¦‚ç°åœ¨åŠ ä¸ªéœ€æ±‚ï¼Œè¦æŸ¥çœ‹æ¯ä¸ªç¯èŠ‚çš„è¾“å‡º:")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("const log = curry((label, x) => {\n\tconsole.log(`${ label }: ${ x }`);\n\treturn x;\n});\n\nconst toSlug = pipe(\n\ttoLowerCase,\t\n\tlog('toLowerCase output'),\n\tsplit(' '),\n\tlog('split output'),\n\tjoin('_'),\n\tlog('join output'),\n\tencodeURIComponent,\n);\nå¤åˆ¶ä»£ç \n")])])])])]),t._v(" "),n("blockquote",[n("p",[t._v("Tips:")]),t._v(" "),n("p",[t._v("ä¸€äº›å·¥å…·çº¯å‡½æ•°å¯ç›´æ¥å¼•ç”¨"),n("code",[t._v("lodash/fp")]),t._v("ï¼Œä¾‹å¦‚"),n("code",[t._v("curry/map/split")]),t._v("ç­‰ï¼Œå¹¶ä¸éœ€è¦åƒæˆ‘ä»¬ä¸Šé¢è¿™æ ·è‡ªå·±å®ç°ï¼›")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("æ•°æ®ä¸å¯å˜æ€§")]),t._v("(immutable): è¿™æ˜¯ä¸€ç§æ•°æ®ç†å¿µï¼Œä¹Ÿæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„æ ¸å¿ƒç†å¿µä¹‹ä¸€:")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("å€¡å¯¼")]),t._v(": ä¸€ä¸ªå¯¹è±¡å†è¢«åˆ›å»ºåä¾¿ä¸ä¼šå†è¢«ä¿®æ”¹ã€‚å½“éœ€è¦æ”¹å˜å€¼æ—¶ï¼Œæ˜¯è¿”å›ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨åŸå¯¹è±¡ä¸Šä¿®æ”¹ï¼›")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("ç›®çš„")]),t._v(": ä¿è¯æ•°æ®çš„ç¨³å®šæ€§ã€‚é¿å…ä¾èµ–çš„æ•°æ®è¢«æœªçŸ¥åœ°ä¿®æ”¹ï¼Œå¯¼è‡´äº†è‡ªèº«çš„æ‰§è¡Œå¼‚å¸¸ï¼Œèƒ½æœ‰æ•ˆæé«˜å¯æ§æ€§ä¸ç¨³å®šæ€§ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("å¹¶ä¸ç­‰åŒäº"),n("code",[t._v("const")]),t._v("ã€‚ä½¿ç”¨"),n("code",[t._v("const")]),t._v("åˆ›å»ºä¸€ä¸ªå¯¹è±¡åï¼Œå®ƒçš„å±æ€§ä»ç„¶å¯ä»¥è¢«ä¿®æ”¹ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("æ›´ç±»ä¼¼äº"),n("code",[t._v("Object.freeze")]),t._v(": å†»ç»“å¯¹è±¡ï¼Œä½†"),n("code",[t._v("freeze")]),t._v("ä»æ— æ³•ä¿è¯æ·±å±‚çš„å±æ€§ä¸è¢«ä¸²æ”¹ï¼›")])]),t._v(" "),n("li",[n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("immutable.js\n")])])]),n("p",[t._v(": js ä¸­çš„æ•°æ®ä¸å¯å˜åº“ï¼Œå®ƒä¿è¯äº†æ•°æ®ä¸å¯å˜ï¼Œåœ¨ React ç”Ÿæ€ä¸­è¢«å¹¿æ³›åº”ç”¨ï¼Œå¤§å¤§æå‡äº†æ€§èƒ½ä¸ç¨³å®šæ€§ï¼›")]),t._v(" "),n("ul",[n("li",[n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("trie\n")])])]),n("p",[t._v("æ•°æ®ç»“æ„:")]),t._v(" "),n("ul",[n("li",[t._v("ä¸€ç§æ•°æ®ç»“æ„ï¼Œèƒ½æœ‰æ•ˆåœ°æ·±åº¦å†»ç»“å¯¹è±¡ï¼Œä¿è¯å…¶ä¸å¯å˜ï¼›")]),t._v(" "),n("li",[n("strong",[t._v("ç»“æ„å…±äº«")]),t._v(": å¯ä»¥å…±ç”¨ä¸å¯å˜å¯¹è±¡çš„å†…å­˜å¼•ç”¨åœ°å€ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜æ•°æ®æ“ä½œæ€§èƒ½ï¼›")])])])])])])]),t._v(" "),n("li",[n("p",[t._v("é¿å…ä¸åŒå‡½æ•°ä¹‹é—´çš„ "),n("strong",[t._v("çŠ¶æ€å…±äº«")]),t._v("ï¼Œæ•°æ®çš„ä¼ é€’ä½¿ç”¨å¤åˆ¶æˆ–å…¨æ–°å¯¹è±¡ï¼Œéµå®ˆæ•°æ®ä¸å¯å˜åŸåˆ™ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("é¿å…ä»å‡½æ•°å†…éƒ¨ "),n("strong",[t._v("æ”¹å˜å¤–éƒ¨çŠ¶æ€")]),t._v("ï¼Œä¾‹å¦‚æ”¹å˜äº†å…¨å±€ä½œç”¨åŸŸæˆ–çˆ¶çº§ä½œç”¨åŸŸä¸Šçš„å˜é‡å€¼ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶å®ƒå•ä½é”™è¯¯ï¼›")])]),t._v(" "),n("li",[n("p",[t._v("é¿å…åœ¨å•å…ƒå‡½æ•°å†…éƒ¨æ‰§è¡Œä¸€äº› "),n("strong",[t._v("å‰¯ä½œç”¨")]),t._v("ï¼Œåº”è¯¥å°†è¿™äº›æ“ä½œæŠ½ç¦»æˆæ›´ç‹¬ç«‹çš„å·¥å…·å•å…ƒï¼›")]),t._v(" "),n("ul",[n("li",[t._v("æ—¥å¿—è¾“å‡º")]),t._v(" "),n("li",[t._v("è¯»å†™æ–‡ä»¶")]),t._v(" "),n("li",[t._v("ç½‘ç»œè¯·æ±‚")]),t._v(" "),n("li",[t._v("è°ƒç”¨å¤–éƒ¨è¿›ç¨‹")]),t._v(" "),n("li",[t._v("è°ƒç”¨æœ‰å‰¯ä½œç”¨çš„å‡½æ•°")])])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("é«˜é˜¶å‡½æ•°")]),t._v(": æ˜¯æŒ‡ ä»¥å‡½æ•°ä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å¢å¼ºå‡½æ•° çš„ä¸€ç±»å‡½æ•°ï¼Œå®ƒé€šå¸¸ç”¨äº:")]),t._v(" "),n("ul",[n("li",[t._v("å°†é€»è¾‘è¡Œä¸ºè¿›è¡Œ "),n("strong",[t._v("éš”ç¦»æŠ½è±¡")]),t._v("ï¼Œä¾¿äºå¿«é€Ÿå¤ç”¨ï¼Œå¦‚å¤„ç†æ•°æ®ï¼Œå…¼å®¹æ€§ç­‰ï¼›")]),t._v(" "),n("li",[n("strong",[t._v("å‡½æ•°ç»„åˆ")]),t._v("ï¼Œå°†ä¸€ç³»åˆ—å•å…ƒå‡½æ•°åˆ—è¡¨ç»„åˆæˆåŠŸèƒ½æ›´å¼ºå¤§çš„å‡½æ•°ï¼›")]),t._v(" "),n("li",[n("strong",[t._v("å‡½æ•°å¢å¼º")]),t._v("ï¼Œå¿«é€Ÿåœ°æ‹“å±•å‡½æ•°åŠŸèƒ½ï¼Œ")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("å‡½æ•°å¼ç¼–ç¨‹çš„å¥½å¤„")]),t._v(":")]),t._v(" "),n("ul",[n("li",[t._v("å‡½æ•°å‰¯ä½œç”¨å°ï¼Œæ‰€æœ‰å‡½æ•°ç‹¬ç«‹å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•è€¦åˆï¼Œå¤ç”¨æ€§æé«˜ï¼›")]),t._v(" "),n("li",[t._v("ä¸å…³æ³¨æ‰§è¡Œæ—¶é—´ï¼Œæ‰§è¡Œé¡ºåºï¼Œå‚æ•°ï¼Œå‘½åç­‰ï¼Œèƒ½ä¸“æ³¨äºæ•°æ®çš„æµåŠ¨ä¸å¤„ç†ï¼Œèƒ½æœ‰æ•ˆæé«˜ç¨³å®šæ€§ä¸å¥å£®æ€§ï¼›")]),t._v(" "),n("li",[t._v("è¿½æ±‚å•å…ƒåŒ–ï¼Œç²’åº¦åŒ–ï¼Œä½¿å…¶é‡æ„å’Œæ”¹é€ æˆæœ¬é™ä½ï¼Œå¯ç»´æŠ¤ã€å¯æ‹“å±•æ€§è¾ƒå¥½ï¼›")]),t._v(" "),n("li",[t._v("æ›´æ˜“äºåšå•å…ƒæµ‹è¯•ã€‚")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("æ€»ç»“")]),t._v(":")]),t._v(" "),n("ul",[n("li",[t._v("å‡½æ•°å¼ç¼–ç¨‹å…¶å®æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œå®ƒè¿½æ±‚æ›´ç»†çš„ç²’åº¦ï¼Œå°†åº”ç”¨æ‹†åˆ†æˆä¸€ç»„ç»„æå°çš„å•å…ƒå‡½æ•°ï¼Œç»„åˆè°ƒç”¨æ“ä½œæ•°æ®æµï¼›")]),t._v(" "),n("li",[t._v("å®ƒæå€¡ç€ çº¯å‡½æ•° / å‡½æ•°å¤åˆ / æ•°æ®ä¸å¯å˜ï¼Œ è°¨æ…å¯¹å¾…å‡½æ•°å†…çš„ çŠ¶æ€å…±äº« / ä¾èµ–å¤–éƒ¨ / å‰¯ä½œç”¨ï¼›")])])])])])}),[],!1,null,null,null);e.default=s.exports}}]);