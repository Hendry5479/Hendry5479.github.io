<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>理念篇 | 英俊的大亨亨</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="heng.png">
    <meta name="description" content="记录下有趣岁月的点点滴滴">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.b51e4ccd.js" as="script"><link rel="preload" href="/assets/js/2.7229199a.js" as="script"><link rel="preload" href="/assets/js/41.8b8ae086.js" as="script"><link rel="prefetch" href="/assets/js/10.00f8a9d8.js"><link rel="prefetch" href="/assets/js/100.78dfd44a.js"><link rel="prefetch" href="/assets/js/101.cdae98a0.js"><link rel="prefetch" href="/assets/js/102.6a3dd9e0.js"><link rel="prefetch" href="/assets/js/103.cfed07a2.js"><link rel="prefetch" href="/assets/js/104.a16a4843.js"><link rel="prefetch" href="/assets/js/105.9cd1add0.js"><link rel="prefetch" href="/assets/js/106.546c1ad8.js"><link rel="prefetch" href="/assets/js/107.04b38bf9.js"><link rel="prefetch" href="/assets/js/108.31a22b61.js"><link rel="prefetch" href="/assets/js/109.1f2a1840.js"><link rel="prefetch" href="/assets/js/11.e2689dc6.js"><link rel="prefetch" href="/assets/js/110.9dc2f13b.js"><link rel="prefetch" href="/assets/js/111.35cf70f8.js"><link rel="prefetch" href="/assets/js/112.39a6579b.js"><link rel="prefetch" href="/assets/js/113.cbfc279d.js"><link rel="prefetch" href="/assets/js/114.878470a2.js"><link rel="prefetch" href="/assets/js/115.86dc4d8e.js"><link rel="prefetch" href="/assets/js/116.d2e05b2c.js"><link rel="prefetch" href="/assets/js/117.7525671d.js"><link rel="prefetch" href="/assets/js/118.a5c04c6d.js"><link rel="prefetch" href="/assets/js/119.613a81e1.js"><link rel="prefetch" href="/assets/js/12.0b7aaea4.js"><link rel="prefetch" href="/assets/js/120.ec6d3159.js"><link rel="prefetch" href="/assets/js/121.6705f783.js"><link rel="prefetch" href="/assets/js/122.7b3fe034.js"><link rel="prefetch" href="/assets/js/123.9336f454.js"><link rel="prefetch" href="/assets/js/124.dca9fc87.js"><link rel="prefetch" href="/assets/js/125.338aa4d8.js"><link rel="prefetch" href="/assets/js/126.a731a9eb.js"><link rel="prefetch" href="/assets/js/127.da74dd90.js"><link rel="prefetch" href="/assets/js/128.3d5e86f2.js"><link rel="prefetch" href="/assets/js/129.ee43b65c.js"><link rel="prefetch" href="/assets/js/13.31064a46.js"><link rel="prefetch" href="/assets/js/130.8a273d75.js"><link rel="prefetch" href="/assets/js/131.a89df4ac.js"><link rel="prefetch" href="/assets/js/132.0daac28c.js"><link rel="prefetch" href="/assets/js/133.b1f23c92.js"><link rel="prefetch" href="/assets/js/134.78621a9c.js"><link rel="prefetch" href="/assets/js/135.f0884a8b.js"><link rel="prefetch" href="/assets/js/136.45114430.js"><link rel="prefetch" href="/assets/js/137.eb295fce.js"><link rel="prefetch" href="/assets/js/138.cc7dc8d3.js"><link rel="prefetch" href="/assets/js/139.c9b1aad6.js"><link rel="prefetch" href="/assets/js/14.0be4ee49.js"><link rel="prefetch" href="/assets/js/15.685fab30.js"><link rel="prefetch" href="/assets/js/16.97f8b16a.js"><link rel="prefetch" href="/assets/js/17.9c7bebeb.js"><link rel="prefetch" href="/assets/js/18.965d9e47.js"><link rel="prefetch" href="/assets/js/19.3d59a8e1.js"><link rel="prefetch" href="/assets/js/20.1573d510.js"><link rel="prefetch" href="/assets/js/21.f46234dd.js"><link rel="prefetch" href="/assets/js/22.6c16fd38.js"><link rel="prefetch" href="/assets/js/23.50a2a38a.js"><link rel="prefetch" href="/assets/js/24.8aff8273.js"><link rel="prefetch" href="/assets/js/25.35a7c496.js"><link rel="prefetch" href="/assets/js/26.af233874.js"><link rel="prefetch" href="/assets/js/27.a3a96a5a.js"><link rel="prefetch" href="/assets/js/28.a1d49602.js"><link rel="prefetch" href="/assets/js/29.174b7d7d.js"><link rel="prefetch" href="/assets/js/3.6038f64c.js"><link rel="prefetch" href="/assets/js/30.a4115d32.js"><link rel="prefetch" href="/assets/js/31.1522875a.js"><link rel="prefetch" href="/assets/js/32.35da527d.js"><link rel="prefetch" href="/assets/js/33.814d63e8.js"><link rel="prefetch" href="/assets/js/34.615b49c1.js"><link rel="prefetch" href="/assets/js/35.856ab789.js"><link rel="prefetch" href="/assets/js/36.2987bc62.js"><link rel="prefetch" href="/assets/js/37.084d12aa.js"><link rel="prefetch" href="/assets/js/38.088f3091.js"><link rel="prefetch" href="/assets/js/39.4ea066d5.js"><link rel="prefetch" href="/assets/js/4.c610d016.js"><link rel="prefetch" href="/assets/js/40.97850ba9.js"><link rel="prefetch" href="/assets/js/42.8ae2cac3.js"><link rel="prefetch" href="/assets/js/43.f8a28187.js"><link rel="prefetch" href="/assets/js/44.5160f68a.js"><link rel="prefetch" href="/assets/js/45.6d4b7130.js"><link rel="prefetch" href="/assets/js/46.44693348.js"><link rel="prefetch" href="/assets/js/47.eb0ac18a.js"><link rel="prefetch" href="/assets/js/48.ce1c6335.js"><link rel="prefetch" href="/assets/js/49.7ec1b16a.js"><link rel="prefetch" href="/assets/js/5.216dfe20.js"><link rel="prefetch" href="/assets/js/50.1f503aa4.js"><link rel="prefetch" href="/assets/js/51.47971163.js"><link rel="prefetch" href="/assets/js/52.e5f681d7.js"><link rel="prefetch" href="/assets/js/53.df89fbb7.js"><link rel="prefetch" href="/assets/js/54.a140a8dd.js"><link rel="prefetch" href="/assets/js/55.5809711e.js"><link rel="prefetch" href="/assets/js/56.3a62759d.js"><link rel="prefetch" href="/assets/js/57.c9bd4339.js"><link rel="prefetch" href="/assets/js/58.acb475d1.js"><link rel="prefetch" href="/assets/js/59.61cf3322.js"><link rel="prefetch" href="/assets/js/6.73a8f323.js"><link rel="prefetch" href="/assets/js/60.aa39146e.js"><link rel="prefetch" href="/assets/js/61.f62972b8.js"><link rel="prefetch" href="/assets/js/62.79fc1ddc.js"><link rel="prefetch" href="/assets/js/63.808c750c.js"><link rel="prefetch" href="/assets/js/64.4e99e2e1.js"><link rel="prefetch" href="/assets/js/65.f112caec.js"><link rel="prefetch" href="/assets/js/66.422cc6c9.js"><link rel="prefetch" href="/assets/js/67.f504a803.js"><link rel="prefetch" href="/assets/js/68.f8e84a65.js"><link rel="prefetch" href="/assets/js/69.af07ae00.js"><link rel="prefetch" href="/assets/js/7.a6e60d89.js"><link rel="prefetch" href="/assets/js/70.9b212396.js"><link rel="prefetch" href="/assets/js/71.049b7d3e.js"><link rel="prefetch" href="/assets/js/72.b508f834.js"><link rel="prefetch" href="/assets/js/73.52a25a21.js"><link rel="prefetch" href="/assets/js/74.68de4c01.js"><link rel="prefetch" href="/assets/js/75.c0d8e99a.js"><link rel="prefetch" href="/assets/js/76.672b246e.js"><link rel="prefetch" href="/assets/js/77.36d886e3.js"><link rel="prefetch" href="/assets/js/78.079ebfd8.js"><link rel="prefetch" href="/assets/js/79.d3d3e8ea.js"><link rel="prefetch" href="/assets/js/8.a72c567f.js"><link rel="prefetch" href="/assets/js/80.c690c3d9.js"><link rel="prefetch" href="/assets/js/81.c012b7d5.js"><link rel="prefetch" href="/assets/js/82.47ffa460.js"><link rel="prefetch" href="/assets/js/83.2ba84114.js"><link rel="prefetch" href="/assets/js/84.dc0bf5a8.js"><link rel="prefetch" href="/assets/js/85.d968ae8b.js"><link rel="prefetch" href="/assets/js/86.91000a3b.js"><link rel="prefetch" href="/assets/js/87.6e885c71.js"><link rel="prefetch" href="/assets/js/88.99dd2b79.js"><link rel="prefetch" href="/assets/js/89.601c57ea.js"><link rel="prefetch" href="/assets/js/9.c59ba06b.js"><link rel="prefetch" href="/assets/js/90.89ee0da5.js"><link rel="prefetch" href="/assets/js/91.854de449.js"><link rel="prefetch" href="/assets/js/92.7a25d006.js"><link rel="prefetch" href="/assets/js/93.17f89281.js"><link rel="prefetch" href="/assets/js/94.0f6749b9.js"><link rel="prefetch" href="/assets/js/95.41ef6f4a.js"><link rel="prefetch" href="/assets/js/96.12427920.js"><link rel="prefetch" href="/assets/js/97.53036963.js"><link rel="prefetch" href="/assets/js/98.43d8f870.js"><link rel="prefetch" href="/assets/js/99.4ab32fce.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/heng.png" alt="英俊的大亨亨" class="logo"> <span class="site-name can-hide">英俊的大亨亨</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">js</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/js-基础.html" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/js/js-数组.html" class="nav-link">
  数组
</a></li><li class="dropdown-item"><!----> <a href="/js/js-异步.html" class="nav-link">
  异步
</a></li><li class="dropdown-item"><!----> <a href="/js/js-es6.html" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/js/js-v8引擎.html" class="nav-link">
  v8
</a></li><li class="dropdown-item"><!----> <a href="/手写代码/1.js基础.html" class="nav-link">
  手写
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/process.html" class="nav-link">
  
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/html.html" class="nav-link">
  html
</a></li><li class="dropdown-item"><!----> <a href="/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/node.html" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/webpack.html" class="nav-link">
  小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="leetcode" class="dropdown-title"><span class="title">leetcode</span> <span class="arrow down"></span></button> <button type="button" aria-label="leetcode" class="mobile-dropdown-title"><span class="title">leetcode</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/代码随想录/1.数组.html" class="nav-link">
  1.数组
</a></li><li class="dropdown-item"><!----> <a href="/代码随想录/10.动态规划/1.基础.html" class="nav-link">
  10.动态规划
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">react源码</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">react源码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react源码/理念.html" class="nav-link">
  1.理念
</a></li><li class="dropdown-item"><!----> <a href="/react源码/3.render.html" class="nav-link">
  3.render
</a></li><li class="dropdown-item"><!----> <a href="/react源码/4.commit.html" class="nav-link">
  4.commit
</a></li><li class="dropdown-item"><!----> <a href="/react源码/5.状态更新.html" class="nav-link">
  5.状态更新
</a></li><li class="dropdown-item"><!----> <a href="/react源码/6.diff.html" class="nav-link">
  6.diff
</a></li><li class="dropdown-item"><!----> <a href="/react/7.实现hooks.html" class="nav-link">
  7.实现hooks
</a></li><li class="dropdown-item"><!----> <a href="/react/8.concurrentMode.html" class="nav-link">
  8.concurrentMode
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">webpack</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">webpack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/1.配置.html" class="nav-link">
  1.配置
</a></li><li class="dropdown-item"><!----> <a href="/webpack/2.loader.html" class="nav-link">
  2.loader
</a></li><li class="dropdown-item"><!----> <a href="/webpack/3.plugin.html" class="nav-link">
  3.plugin
</a></li><li class="dropdown-item"><!----> <a href="/webpack/4.模块化原理.html" class="nav-link">
  4.模块化原理
</a></li><li class="dropdown-item"><!----> <a href="/webpack/5.babel.html" class="nav-link">
  5.babel
</a></li><li class="dropdown-item"><!----> <a href="/webpack/6.HMR.html" class="nav-link">
  6.HMR
</a></li><li class="dropdown-item"><!----> <a href="/webpack/7.环境分离.html" class="nav-link">
  7.环境分离
</a></li><li class="dropdown-item"><!----> <a href="/webpack/8.tree_shaking.html" class="nav-link">
  8.tree_shaking
</a></li><li class="dropdown-item"><!----> <a href="/webpack/9,源码.html" class="nav-link">
  9.源码
</a></li><li class="dropdown-item"><!----> <a href="/webpack/11.自定义loader.html" class="nav-link">
  11.自定义loader
</a></li><li class="dropdown-item"><!----> <a href="/webpack/12.自定义plugin.html" class="nav-link">
  12.自定义plugin
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端设计模式</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端设计模式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/设计模式/创建型.html" class="nav-link">
  创建型
</a></li><li class="dropdown-item"><!----> <a href="/设计模式/结构型.html" class="nav-link">
  结构型
</a></li><li class="dropdown-item"><!----> <a href="/设计模式/行为型.html" class="nav-link">
  行为型
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">angular</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">angular</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/react%E6%BA%90%E7%A0%81/.html" class="nav-link">
  angular性能调优
</a></li><li class="dropdown-item"><!----> <a href="/设计模式/结构型.html" class="nav-link">
  angular源码理解
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">健身</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">健身</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/react%E6%BA%90%E7%A0%81/.html" class="nav-link">
  angular性能调优
</a></li><li class="dropdown-item"><!----> <a href="/设计模式/结构型.html" class="nav-link">
  angular源码理解
</a></li></ul></div></div><div class="nav-item"><a href="/me.html" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">js</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/js-基础.html" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/js/js-数组.html" class="nav-link">
  数组
</a></li><li class="dropdown-item"><!----> <a href="/js/js-异步.html" class="nav-link">
  异步
</a></li><li class="dropdown-item"><!----> <a href="/js/js-es6.html" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/js/js-v8引擎.html" class="nav-link">
  v8
</a></li><li class="dropdown-item"><!----> <a href="/手写代码/1.js基础.html" class="nav-link">
  手写
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/process.html" class="nav-link">
  
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/html.html" class="nav-link">
  html
</a></li><li class="dropdown-item"><!----> <a href="/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/node.html" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/webpack.html" class="nav-link">
  小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="leetcode" class="dropdown-title"><span class="title">leetcode</span> <span class="arrow down"></span></button> <button type="button" aria-label="leetcode" class="mobile-dropdown-title"><span class="title">leetcode</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/代码随想录/1.数组.html" class="nav-link">
  1.数组
</a></li><li class="dropdown-item"><!----> <a href="/代码随想录/10.动态规划/1.基础.html" class="nav-link">
  10.动态规划
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">react源码</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">react源码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react源码/理念.html" class="nav-link">
  1.理念
</a></li><li class="dropdown-item"><!----> <a href="/react源码/3.render.html" class="nav-link">
  3.render
</a></li><li class="dropdown-item"><!----> <a href="/react源码/4.commit.html" class="nav-link">
  4.commit
</a></li><li class="dropdown-item"><!----> <a href="/react源码/5.状态更新.html" class="nav-link">
  5.状态更新
</a></li><li class="dropdown-item"><!----> <a href="/react源码/6.diff.html" class="nav-link">
  6.diff
</a></li><li class="dropdown-item"><!----> <a href="/react/7.实现hooks.html" class="nav-link">
  7.实现hooks
</a></li><li class="dropdown-item"><!----> <a href="/react/8.concurrentMode.html" class="nav-link">
  8.concurrentMode
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">webpack</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">webpack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/1.配置.html" class="nav-link">
  1.配置
</a></li><li class="dropdown-item"><!----> <a href="/webpack/2.loader.html" class="nav-link">
  2.loader
</a></li><li class="dropdown-item"><!----> <a href="/webpack/3.plugin.html" class="nav-link">
  3.plugin
</a></li><li class="dropdown-item"><!----> <a href="/webpack/4.模块化原理.html" class="nav-link">
  4.模块化原理
</a></li><li class="dropdown-item"><!----> <a href="/webpack/5.babel.html" class="nav-link">
  5.babel
</a></li><li class="dropdown-item"><!----> <a href="/webpack/6.HMR.html" class="nav-link">
  6.HMR
</a></li><li class="dropdown-item"><!----> <a href="/webpack/7.环境分离.html" class="nav-link">
  7.环境分离
</a></li><li class="dropdown-item"><!----> <a href="/webpack/8.tree_shaking.html" class="nav-link">
  8.tree_shaking
</a></li><li class="dropdown-item"><!----> <a href="/webpack/9,源码.html" class="nav-link">
  9.源码
</a></li><li class="dropdown-item"><!----> <a href="/webpack/11.自定义loader.html" class="nav-link">
  11.自定义loader
</a></li><li class="dropdown-item"><!----> <a href="/webpack/12.自定义plugin.html" class="nav-link">
  12.自定义plugin
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端设计模式</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端设计模式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/设计模式/创建型.html" class="nav-link">
  创建型
</a></li><li class="dropdown-item"><!----> <a href="/设计模式/结构型.html" class="nav-link">
  结构型
</a></li><li class="dropdown-item"><!----> <a href="/设计模式/行为型.html" class="nav-link">
  行为型
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">angular</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">angular</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/react%E6%BA%90%E7%A0%81/.html" class="nav-link">
  angular性能调优
</a></li><li class="dropdown-item"><!----> <a href="/设计模式/结构型.html" class="nav-link">
  angular源码理解
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">健身</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">健身</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/react%E6%BA%90%E7%A0%81/.html" class="nav-link">
  angular性能调优
</a></li><li class="dropdown-item"><!----> <a href="/设计模式/结构型.html" class="nav-link">
  angular源码理解
</a></li></ul></div></div><div class="nav-item"><a href="/me.html" class="nav-link">
  关于我
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>react源码</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/react源码/1.理念篇.html" class="active sidebar-link">理念篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/1.理念篇.html#_1-react16架构" class="sidebar-link">1. React16架构</a></li><li class="sidebar-sub-header"><a href="/react/react源码/1.理念篇.html#_2-fiber结构" class="sidebar-link">2. Fiber结构</a></li><li class="sidebar-sub-header"><a href="/react/react源码/1.理念篇.html#_3-双缓存fiber树" class="sidebar-link">3. 双缓存Fiber树</a></li></ul></li><li><a href="/react/react源码/3.render.html" class="sidebar-link">Reconcile（render阶段）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#递-阶段" class="sidebar-link">“递”阶段</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#归-阶段" class="sidebar-link">“归”阶段</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#update时" class="sidebar-link">update时</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#mount时" class="sidebar-link">mount时</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#reconcilechildren" class="sidebar-link">reconcileChildren</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#effecttag" class="sidebar-link">effectTag</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#流程概览" class="sidebar-link">流程概览</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#处理hostcomponent" class="sidebar-link">处理HostComponent</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#update时-2" class="sidebar-link">update时</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#mount时-2" class="sidebar-link">mount时</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#effectlist" class="sidebar-link">effectList</a></li><li class="sidebar-sub-header"><a href="/react/react源码/3.render.html#流程结尾" class="sidebar-link">流程结尾</a></li></ul></li><li><a href="/react/react源码/4.commit.html" class="sidebar-link">/react/react源码/4.commit.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#before-mutation之前" class="sidebar-link">before mutation之前</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#layout之后" class="sidebar-link">layout之后</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#beforemutation" class="sidebar-link">beforeMutation</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#commitbeforemutationeffects" class="sidebar-link">commitBeforeMutationEffects</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#调用getsnapshotbeforeupdate" class="sidebar-link">调用getSnapshotBeforeUpdate</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#调度useeffect" class="sidebar-link">调度useEffect</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#概览" class="sidebar-link">概览</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#commitmutationeffects" class="sidebar-link">commitMutationEffects</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#placement-effect" class="sidebar-link">Placement effect</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#update-effect" class="sidebar-link">Update effect</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#deletion-effect" class="sidebar-link">Deletion effect</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#总结-2" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#概览-2" class="sidebar-link">概览</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#commitlayouteffects" class="sidebar-link">commitLayoutEffects</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#commitlayouteffectonfiber" class="sidebar-link">commitLayoutEffectOnFiber</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#commitattachref" class="sidebar-link">commitAttachRef</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#current-fiber树切换" class="sidebar-link">current Fiber树切换</a></li><li class="sidebar-sub-header"><a href="/react/react源码/4.commit.html#总结-3" class="sidebar-link">总结</a></li></ul></li><li><a href="/react/react源码/5.diff算法.html" class="sidebar-link">/react/react源码/5.diff算法.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#diff的瓶颈以及react如何应对" class="sidebar-link">Diff的瓶颈以及React如何应对</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#diff是如何实现的" class="sidebar-link">Diff是如何实现的</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#练习题" class="sidebar-link">[#](https://react.iamkasong.com/diff/one.html#练习题)练习题</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#概览" class="sidebar-link">[#](https://react.iamkasong.com/diff/multi.html#概览)概览</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#diff的思路" class="sidebar-link">[#](https://react.iamkasong.com/diff/multi.html#diff的思路)Diff的思路</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#第一轮遍历" class="sidebar-link">[#](https://react.iamkasong.com/diff/multi.html#第一轮遍历)第一轮遍历</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#第二轮遍历" class="sidebar-link">[#](https://react.iamkasong.com/diff/multi.html#第二轮遍历)第二轮遍历</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#处理移动的节点" class="sidebar-link">[#](https://react.iamkasong.com/diff/multi.html#处理移动的节点)处理移动的节点</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#标记节点是否移动" class="sidebar-link">[#](https://react.iamkasong.com/diff/multi.html#标记节点是否移动)标记节点是否移动</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#demo1" class="sidebar-link">[#](https://react.iamkasong.com/diff/multi.html#demo1)Demo1</a></li><li class="sidebar-sub-header"><a href="/react/react源码/5.diff算法.html#demo2" class="sidebar-link">[#](https://react.iamkasong.com/diff/multi.html#demo2)Demo2</a></li></ul></li><li><a href="/react/react源码/6.1.状态更新.html" class="sidebar-link">几个关键节点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#几个关键节点" class="sidebar-link">几个关键节点</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#" class="sidebar-link"></a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#同步更新的react" class="sidebar-link">同步更新的React</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#并发更新的react" class="sidebar-link">[#](https://react.iamkasong.com/state/mental.html#并发更新的react)并发更新的React</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#update的分类" class="sidebar-link">Update的分类</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#update的结构" class="sidebar-link">Update的结构</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#update与fiber的联系" class="sidebar-link">Update与Fiber的联系</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#updatequeue" class="sidebar-link">updateQueue</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.1.状态更新.html#例子" class="sidebar-link">例子</a></li></ul></li><li><a href="/react/react源码/6.2.优先级.html" class="sidebar-link">什么是优先级</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#什么是优先级" class="sidebar-link">什么是优先级</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#如何调度优先级" class="sidebar-link">[#](https://react.iamkasong.com/state/priority.html#如何调度优先级)如何调度优先级</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#例子" class="sidebar-link">[#](https://react.iamkasong.com/state/priority.html#例子)例子</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#如何保证状态正确" class="sidebar-link">[#](https://react.iamkasong.com/state/priority.html#如何保证状态正确)如何保证状态正确</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#创建fiber" class="sidebar-link">[#](https://react.iamkasong.com/state/reactdom.html#创建fiber)创建fiber</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#创建update" class="sidebar-link">[#](https://react.iamkasong.com/state/reactdom.html#创建update)创建update</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#流程概览" class="sidebar-link">[#](https://react.iamkasong.com/state/reactdom.html#流程概览)流程概览</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#react的其他入口函数" class="sidebar-link">[#](https://react.iamkasong.com/state/reactdom.html#react的其他入口函数)React的其他入口函数</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#流程概览-2" class="sidebar-link">[#](https://react.iamkasong.com/state/setstate.html#流程概览)流程概览</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#this-forceupdate" class="sidebar-link">[#](https://react.iamkasong.com/state/setstate.html#this-forceupdate)this.forceUpdate</a></li><li class="sidebar-sub-header"><a href="/react/react源码/6.2.优先级.html#总结" class="sidebar-link">[#](https://react.iamkasong.com/state/setstate.html#总结)总结</a></li></ul></li><li><a href="/react/react源码/7.1.实现hooks.html" class="sidebar-link">/react/react源码/7.1.实现hooks.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#从logo聊起" class="sidebar-link">[#](https://react.iamkasong.com/hooks/prepare.html#从logo聊起)从LOGO聊起</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#总结" class="sidebar-link">[#](https://react.iamkasong.com/hooks/prepare.html#总结)总结</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#工作原理" class="sidebar-link">工作原理</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#更新是什么" class="sidebar-link">更新是什么</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#update数据结构" class="sidebar-link">update数据结构</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#状态如何保存" class="sidebar-link">状态如何保存</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#hook数据结构" class="sidebar-link">Hook数据结构</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#模拟react调度更新流程" class="sidebar-link">模拟React调度更新流程</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#计算state" class="sidebar-link">计算state</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#对触发事件进行抽象" class="sidebar-link">对触发事件进行抽象</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#在线demo" class="sidebar-link">在线Demo</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.1.实现hooks.html#与react的区别" class="sidebar-link">与React的区别</a></li></ul></li><li><a href="/react/react源码/7.2.useState和useReducer.html" class="sidebar-link">dispatcher</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/7.2.useState和useReducer.html#dispatcher" class="sidebar-link">dispatcher</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.2.useState和useReducer.html#一个dispatcher使用场景" class="sidebar-link">[#](https://react.iamkasong.com/hooks/structure.html#一个dispatcher使用场景)一个dispatcher使用场景</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.2.useState和useReducer.html#hook的数据结构" class="sidebar-link">[#](https://react.iamkasong.com/hooks/structure.html#hook的数据结构)Hook的数据结构</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.2.useState和useReducer.html#memoizedstate" class="sidebar-link">[#](https://react.iamkasong.com/hooks/structure.html#memoizedstate)memoizedState</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.2.useState和useReducer.html#流程概览" class="sidebar-link">[#](https://react.iamkasong.com/hooks/usestate.html#流程概览)流程概览</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.2.useState和useReducer.html#声明阶段" class="sidebar-link">[#](https://react.iamkasong.com/hooks/usestate.html#声明阶段)声明阶段</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.2.useState和useReducer.html#调用阶段" class="sidebar-link">[#](https://react.iamkasong.com/hooks/usestate.html#调用阶段)调用阶段</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.2.useState和useReducer.html#小tip" class="sidebar-link">[#](https://react.iamkasong.com/hooks/usestate.html#小tip)小Tip</a></li></ul></li><li><a href="/react/react源码/7.3.useEffect.html" class="sidebar-link">/react/react源码/7.3.useEffect.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/7.3.useEffect.html#flushpassiveeffectsimpl" class="sidebar-link">[#](https://react.iamkasong.com/hooks/useeffect.html#flushpassiveeffectsimpl)flushPassiveEffectsImpl</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.3.useEffect.html#阶段一-销毁函数的执行" class="sidebar-link">[#](https://react.iamkasong.com/hooks/useeffect.html#阶段一-销毁函数的执行)阶段一：销毁函数的执行</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.3.useEffect.html#阶段二-回调函数的执行" class="sidebar-link">[#](https://react.iamkasong.com/hooks/useeffect.html#阶段二-回调函数的执行)阶段二：回调函数的执行</a></li></ul></li><li><a href="/react/react源码/7.4.useRef和useMemo.html" class="sidebar-link">/react/react源码/7.4.useRef和useMemo.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/7.4.useRef和useMemo.html#useref" class="sidebar-link">[#](https://react.iamkasong.com/hooks/useref.html#useref)useRef</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.4.useRef和useMemo.html#ref的工作流程" class="sidebar-link">[#](https://react.iamkasong.com/hooks/useref.html#ref的工作流程)ref的工作流程</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.4.useRef和useMemo.html#render阶段" class="sidebar-link">[#](https://react.iamkasong.com/hooks/useref.html#render阶段)render阶段</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.4.useRef和useMemo.html#commit阶段" class="sidebar-link">[#](https://react.iamkasong.com/hooks/useref.html#commit阶段)commit阶段</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.4.useRef和useMemo.html#总结" class="sidebar-link">[#](https://react.iamkasong.com/hooks/useref.html#总结)总结</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.4.useRef和useMemo.html#mount" class="sidebar-link">mount</a></li><li class="sidebar-sub-header"><a href="/react/react源码/7.4.useRef和useMemo.html#update" class="sidebar-link">[#](https://react.iamkasong.com/hooks/usememo.html#update)update</a></li></ul></li><li><a href="/react/react源码/源码.html" class="sidebar-link">1. 理念篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#_1-1-react的设计理念" class="sidebar-link">1.1 React的设计理念</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#_1-2-架构演进" class="sidebar-link">1.2 架构演进</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#_1-3-fiber架构的工作原理" class="sidebar-link">1.3 Fiber架构的工作原理</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#_1-4-文件目录" class="sidebar-link">1.4 文件目录</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#render" class="sidebar-link">render</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#commit" class="sidebar-link">commit</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#diff算法" class="sidebar-link">Diff算法</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#状态更新" class="sidebar-link">状态更新</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#生命周期" class="sidebar-link">生命周期</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#hooks" class="sidebar-link">Hooks</a></li><li class="sidebar-sub-header"><a href="/react/react源码/源码.html#异步调度" class="sidebar-link">异步调度</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="理念篇"><a href="#理念篇" class="header-anchor">#</a> 理念篇</h1> <h2 id="_1-react16架构"><a href="#_1-react16架构" class="header-anchor">#</a> 1. React16架构</h2> <p>React15的缺点：<strong>更新无法被中断</strong>，中断会<strong>渲染不完全</strong>，React16支持异步更新</p> <p><strong>Scheduler</strong>和<strong>Reconciler</strong>都是平台无关的，所以是单独发包的</p> <h3 id="scheduler调度"><a href="#scheduler调度" class="header-anchor">#</a> Scheduler调度</h3> <p><strong>调度任务的优先级，高优进入</strong>Reconciler</p> <p><strong>以浏览器是否有剩余时间作为任务中断的标准</strong></p> <p>需要一种机制，当浏览器有剩余时间时通知我们，浏览器实现了这个API：requestIdleCallback，但兼容性和不稳定而弃用</p> <p><code>React的Scheduler</code> 就是实现了 <code>requestIdleCallback</code> polyfill</p> <p>除了在空闲时触发回调的功能外，<strong>Scheduler</strong>还提供了多种调度优先级供任务设置</p> <h3 id="reconciler协调"><a href="#reconciler协调" class="header-anchor">#</a> Reconciler协调</h3> <p>负责找出变化的组件</p> <p><strong>从递归处理虚拟DOM，变成可中断的循环</strong></p> <p>每次循环都会调用 <code>shouldYield</code>判断当前是否有剩余时间。</p> <p><strong>React16解决中断更新时DOM渲染不完全的问题</strong>：</p> <p><strong>Reconciler</strong>与<strong>Renderer</strong>不再是交替工作。当<strong>Scheduler</strong>将任务交给<strong>Reconciler</strong>后，<strong>Reconciler</strong>会为Fiber打上代表增/删/更新的标记</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> Placement <span class="token operator">=</span> <span class="token comment">/*             */</span> <span class="token number">0b0000000000010</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> Update <span class="token operator">=</span> <span class="token comment">/*                */</span> <span class="token number">0b0000000000100</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Scheduler与Reconciler的工作都在内存中进行。</strong></p> <p><strong>只有当所有组件都完成Reconciler的工作，才会统一交给Renderer。</strong></p> <h3 id="renderer渲染器"><a href="#renderer渲染器" class="header-anchor">#</a> Renderer渲染器</h3> <p><strong>Renderer</strong>根据<strong>Reconciler</strong>打的标记<strong>effectTag</strong>，同步执行DOM操作。</p> <p>浏览器环境的Mutation指dom操作</p> <p>![image-20211104234422329](/Users/hendry5479/Library/Application Support/typora-user-images/image-20211104234422329.png)</p> <p>红框步骤随时可能因为高优或者当前帧没有剩余时间被中断：</p> <p>红框的工作都在内存进行，不更新DOM，所以反复中断无感知</p> <h2 id="_2-fiber结构"><a href="#_2-fiber结构" class="header-anchor">#</a> 2. Fiber结构</h2> <p><code>React Fiber</code>可以理解为：<code>React</code>的一套状态更新机制。支持任务 <code>优先级</code>，可中断恢复，恢复可复用中间状态。</p> <p>Fiber节点是任务的更新单元</p> <p><code>Fiber</code>包含三层含义：树结构return和child和sibling，</p> <ol><li>架构：老 <code>Reconciler</code>递归执行，数据保存在递归调用栈。新Reconciler基于Fiber节点，<code>Fiber Reconciler</code>。</li> <li>静态数据结构：<code>Fiber节点</code>保存组件类型、DOM信息</li> <li>动态工作单元：保存了改变的状态、DOM操作。</li></ol> <h3 id="作为架构来说"><a href="#作为架构来说" class="header-anchor">#</a> 作为架构来说</h3> <p>每个Fiber节点有对应的 <code>React element</code>，多个 <code>Fiber节点</code>是如何连接形成树呢？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 指向父级Fiber节点</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>return <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// 指向子Fiber节点</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>child <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// 指向右边第一个兄弟Fiber节点</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>sibling <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><p>为什么父级指针叫做 <code>return</code>？因为作为工作单元，<strong><code>return</code>指节点执行完 <code>completeWork</code>后返回的下一个节点</strong>。</p> <p>子 <code>Fiber节点</code>及其兄弟节点完成工作后会返回其父级节点，所以用 <code>return</code>指代父级节点。</p> <h3 id="作为静态的数据结构"><a href="#作为静态的数据结构" class="header-anchor">#</a> 作为静态的数据结构</h3> <p>保存了组件相关的信息：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Fiber对应组件的类型 </span>
<span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> tag<span class="token punctuation">;</span>  <span class="token comment">// Function/Class/Host...</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
<span class="token comment">// 对于 FunctionComponent，指函数本身，对于ClassComponent，指class，对于HostComponent，指DOM节点tagName</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token comment">// Fiber对应的真实DOM节点</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>stateNode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="作为动态的工作单元"><a href="#作为动态的工作单元" class="header-anchor">#</a> 作为动态的工作单元</h3> <p>保存了本次更新相关的信息</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 保存本次更新造成的状态改变相关信息</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>pendingProps <span class="token operator">=</span> pendingProps<span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>memoizedProps <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>updateQueue <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>mode <span class="token operator">=</span> mode<span class="token punctuation">;</span>


<span class="token comment">// 保存本次更新会造成的DOM操作</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>effectTag <span class="token operator">=</span> NoEffect<span class="token punctuation">;</span>


<span class="token keyword">this</span><span class="token punctuation">.</span>nextEffect <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>firstEffect <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>lastEffect <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><p>如下两个字段保存调度优先级相关的信息，会在讲解 <code>Scheduler</code>时介绍。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 调度优先级相关</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>lanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>childLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>
</code></pre></div><h2 id="_3-双缓存fiber树"><a href="#_3-双缓存fiber树" class="header-anchor">#</a> 3. 双缓存Fiber树</h2> <p>在 <code>React</code>中存在两棵 <code>Fiber树</code>。当前显示的 <code>current Fiber树</code>，正在内存中构建的 <code>workInProgress Fiber树</code>。</p> <p><code>current fiber</code>和 <code>workInProgress fiber</code>，通过 <code>alternate</code>属性连接</p> <div class="language-js extra-class"><pre class="language-js"><code>currentFiber<span class="token punctuation">.</span>alternate <span class="token operator">===</span> workInProgressFiber<span class="token punctuation">;</span>
workInProgressFiber<span class="token punctuation">.</span>alternate <span class="token operator">===</span> currentFiber<span class="token punctuation">;</span>
</code></pre></div><p><code>React</code>根节点通过<strong>使 <code>current</code>指针在不同 <code>rootFiber</code>间切换</strong>完成 <code>current Fiber</code>树指向的切换，从而完成 <code>DOM</code>更新。</p> <h3 id="mount时"><a href="#mount时" class="header-anchor">#</a> mount时</h3> <ol><li>首次执行 <code>ReactDOM.render</code>会创建 <code>fiberRoot</code>和 <code>rootFiber</code>。</li></ol> <p>在应用中会多次调用 <code>ReactDOM.render</code>，渲染出来不同的<strong>组件树</strong>，他们会拥有不同的 <code>rootFiber</code>。</p> <p>但是整个应用的根节点只有一个，那就是 <code>fiberRoot</code>。</p> <p><code>fiberRoot</code>的 <code>current</code>指向当前页对应的 <code>current Fiber树</code></p> <div class="language-js extra-class"><pre class="language-js"><code>fiberRootNode<span class="token punctuation">.</span>current <span class="token operator">=</span> rootFiber<span class="token punctuation">;</span>
</code></pre></div><p>首屏渲染，<code>fiberRootNode.current</code>指向的 <code>rootFiber</code>没有任何 <code>子Fiber节点</code>（即 <code>current Fiber树</code>为空）</p> <ol start="2"><li>之后进入 <code>render阶段</code>，根据组件返回的 <code>JSX</code>在内存中依次创建 <code>Fiber节点</code>并构建 <code>workInProgress Fiber树</code></li></ol> <p>在构建 <code>workInProgress树</code>时会尝试复用 <code>current Fiber树</code>中已有的 <code>Fiber节点</code>内的属性</p> <p><strong>在 <code>首屏渲染</code>时只有 <code>rootFiber</code>存在对应的 <code>current fiber</code></strong>（即 <code>rootFiber.alternate</code>）</p> <ol start="3"><li>已构建完的 <code>workInProgress Fiber树</code>在 <code>commit阶段</code>渲染到页面。</li></ol> <p><strong>渲染完毕后 <code>fiberRoot</code>的 <code>current</code>指针指向切换。</strong></p> <h3 id="update时"><a href="#update时" class="header-anchor">#</a> update时</h3> <ol><li>状态改变开启新的 <code>render阶段</code>并构建新的 <code>workInProgress树</code></li></ol> <p>和 <code>mount</code>时一样，<code>workInProgress fiber</code>的创建可以复用 <code>current Fiber树</code>对应的节点数据。</p> <ol start="2"><li><code>workInProgress树</code>在 <code>render阶段</code>完成构建后进入 <code>commit阶段</code>渲染到页面上。渲染完毕后fiberRoot指针切换。</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/react/react源码/3.render.html">
        Reconcile（render阶段）
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b51e4ccd.js" defer></script><script src="/assets/js/2.7229199a.js" defer></script><script src="/assets/js/41.8b8ae086.js" defer></script>
  </body>
</html>
